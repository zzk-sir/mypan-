import{_ as q,r as n,c as x,d as s,f as p,w as o,D as K,b as d,o as c,g as _,i as m,F as U,e as v,t as C,j as H,v as A,x as G}from"./index-Cp_zlRUQ.js";const J=u=>(A("data-v-e8bcd1a2"),u=u(),G(),u),P={class:"top"},Q={class:"top-op"},W=J(()=>s("span",{class:"iconfont icon-cancel"},null,-1)),X={class:"search-panel"},Y={class:"file-list"},Z=["onMouseenter","onMouseleave"],ee=["title"],ae={class:"opt"},te=["title"],se={__name:"Share",setup(u){const{proxy:l}=H(),M=[{label:"文件名",prop:"fileName",scopedSlots:"fileName"},{label:"分享时间",prop:"shareTime",width:200},{label:"失效时间",prop:"expireTime",scopedSlots:"expireTime",width:200},{label:"浏览次数",prop:"showCount",width:200}],N={loadDataList:"/share/loadDataList",cancelShare:"/share/cancelShare"},i=n([]),$=n(document.location.origin+"/shareCheck/"),r=n({}),V={extHeight:20,selectType:"checkBox"},h=n([]),y=n();n();const z=()=>{i.value.length!=0&&(h.value=i.value,console.log(h.value),I())},B=a=>{h.value=[a.shareId],I()},I=()=>{l.Confirm("你确定要取消分享吗?",async()=>{await l.Request({url:N.cancelShare,params:{shareIds:h.value.join(",")}})&&(l.Message.success("取消分享成功"),f())})},D=()=>{f()},L=a=>{i.value=[],a.forEach(t=>{i.value.push(t.shareId)})},S=a=>{r.value.list.forEach(t=>{t.showOp=!1}),a.showOp=!0},O=a=>{a.showOp=!1},F=async a=>{await l.toClipboard(`${$.value}${a.shareId} 提取码：${a.code}`).then(t=>{l.Message.success("复制成功")}).catch(t=>{l.Message.error(`复制失败：${t}`)})},w=()=>{f()},f=async()=>{let a={pageNo:r.value.pageNo||1,pageSize:r.value.pageSize||15,fileNameFuzzy:y.value||""},t=await l.Request({url:N.loadDataList,params:a});t&&(r.value=t)};return(a,t)=>{const k=d("el-button"),R=d("el-input"),T=d("Icon"),E=d("el-popover"),j=d("Table");return c(),x("div",null,[s("div",P,[s("div",Q,[p(k,{type:"primary",disabled:i.value.length==0,onClick:z},{default:o(()=>[W,_(" 取消分享")]),_:1},8,["disabled"]),s("div",X,[p(R,{clearable:"",placeholder:"请输入分享文件名搜索",modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=b=>y.value=b),modelModifiers:{trim:!0},onKeyup:K(D,["enter"])},{suffix:o(()=>[s("i",{class:"iconfont icon-search",onClick:D})]),_:1},8,["modelValue"])]),s("div",{class:"iconfont icon-refresh",onClick:w})]),s("div",Y,[p(j,{ref:"dataTableRef",columns:M,dataSource:r.value,fetch:f,initFetch:!0,options:V,onRowSelected:L},{fileName:o(({index:b,row:e})=>[s("div",{class:"file-item",onMouseenter:g=>S(e),onMouseleave:g=>O(e)},[e.fileType==3||e.fileType==1&&e.status!=0?(c(),m(T,{key:0,cover:e.fileCover},null,8,["cover"])):(c(),x(U,{key:1},[e.folderType==0?(c(),m(T,{key:0,fileType:e.fileType},null,8,["fileType"])):v("",!0),e.folderType==1?(c(),m(T,{key:1,fileType:0})):v("",!0)],64)),S?v("",!0):(c(),x("span",{key:2,class:"file-name",title:e.fileName},C(e.fileName),9,ee)),S?(c(),m(E,{key:3,placement:"left",width:20,trigger:"hover"},{reference:o(()=>[s("span",{class:"file-name",title:e.fileName},C(e.fileName),9,te)]),default:o(()=>[s("div",ae,[p(k,{class:"iconfont icon-link",onClick:g=>F(e)},{default:o(()=>[_("复制链接")]),_:2},1032,["onClick"]),p(k,{class:"iconfont icon-cancel",onClick:g=>B(e)},{default:o(()=>[_("取消分享")]),_:2},1032,["onClick"])])]),_:2},1024)):v("",!0)],40,Z)]),expireTime:o(({index:b,row:e})=>[_(C(e.validType==3?"永久":e.expireTime),1)]),_:1},8,["dataSource"])])])])}}},le=q(se,[["__scopeId","data-v-e8bcd1a2"]]);export{le as default};
