import{_ as Se,u as ze,a as Be,r as R,b as T,o as C,c as K,d as I,F as pe,e as ee,f as k,w as E,g as ae,h as it,i as Q,t as Y,j as ve,k as lt,n as Oe,l as De,m as Ae,p as se,q as ke,s as we,v as Ye,x as Ve,y as rt,z as Ce,A as Ue,B as ut}from"./index-DYA5YiAB.js";import{m as Re}from"./md5-Cfs3N41m.js";const ct={class:"avatar-upload"},ht={class:"avatar-show"},dt=["src"],ft=["src"],pt={class:"select-btn"},wt={__name:"AvatarUpload",props:{modelValue:{type:Object,default:null}},setup(n,{emit:e}){ze(),Be(),R("");const s=R(null),t=async a=>{a=a.file;let i=new FileReader;i.readAsDataURL(a),i.onload=({target:d})=>{s.value=d.result},o("update:modelValue",a)},o=e;return(a,i)=>{const d=T("el-button"),u=T("el-upload");return C(),K("div",ct,[I("div",ht,[s.value?(C(),K("img",{key:0,src:s.value},null,8,dt)):(C(),K(pe,{key:1},[n.modelValue.userId?(C(),K("img",{key:0,src:`/api/getAvatar/${n.modelValue.userId}`},null,8,ft)):ee("",!0)],64))]),I("div",pt,[k(u,{name:"file","show-file-list":!1,accept:".png,.PNG,.jpg,.JPG,.jpeg,.JPEG,.gif,.GIF,.bmp,.BMP",multiple:!1,"http-request":t},{default:E(()=>[k(d,{type:"primary"},{default:E(()=>[ae("选择")]),_:1})]),_:1})])])}}},mt=Se(wt,[["__scopeId","data-v-367a1150"]]),vt={__name:"UpdateAvatar",emits:[],setup(n,{expose:e,emit:s}){const{proxy:t}=ve(),o={updateUserAvatar:"/updateUserAvatar"},a=R({}),i=R(),d={title:[{require:!0,message:"请输入内容"}]},u=it({show:!1,title:"修改头像",buttons:[{type:"danger",text:"确定",click:c=>{r()}}]}),h=s;e({show:c=>{a.value=Object.assign({},c),a.value.avatar={userId:c.id},u.show=!0}});const r=async()=>{if(!(a.value.avatar instanceof File)){u.show=!1;return}await t.Request({url:o.updateUserAvatar,params:{avatar:a.value.avatar}})&&(u.show=!1,h("updateAvatar"))};return(c,f)=>{const m=T("el-form-item"),g=T("el-form"),A=T("Dialog");return C(),Q(A,{show:u.show,title:u.title,buttons:u.buttons,width:"400px",showCancel:!1,onClose:f[2]||(f[2]=b=>u.show=!1)},{default:E(()=>[k(g,{model:a.value,rules:d,ref:i.value,"label-width":"80px",onSubmit:f[1]||(f[1]=()=>{})},{default:E(()=>[k(m,{label:"昵称"},{default:E(()=>[ae(Y(a.value.nickName),1)]),_:1}),k(m,{label:"头像上传",prop:""},{default:E(()=>[k(mt,{modelValue:a.value.avatar,"onUpdate:modelValue":f[0]||(f[0]=b=>a.value.avatar=b)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])}}},gt=I("span",{class:"iconfont icon-password"},null,-1),_t=I("span",{class:"iconfont icon-password"},null,-1),It={__name:"UpdatePassword",setup(n,{expose:e}){const{proxy:s}=ve(),t=(r,c,f)=>{c!==i.value.password?f(new Error(r.message)):f()},o={updatePassword:"/updatePassword"},a=R(),i=R({}),d=R({show:!1,title:"修改密码",buttons:[{type:"primary",text:"确定",click:()=>{p()}}]}),u={password:[{required:!0,message:"请输入密码"},{validator:s.Verify.password,message:"请输入数字,字母,-,_,且长度在8-32之间的密码"}],rePassword:[{required:!0,message:"请再次输入密码"},{validator:t,message:"两次密码不一致"}]};e({show:()=>{d.value.show=!0,Oe(()=>{a.value.resetFields(),i.value={}})}});const p=()=>{a.value.validate(async r=>{if(!r||!await s.Request({url:o.updatePassword,params:{password:Re(i.value.password)}}))return;d.value.show=!1;let f=s.LocalStorage.get("loginInfo");f.password=Re(i.value.password),s.LocalStorage.update("loginInfo",f),s.Message.success("密码修改成功")})};return(r,c)=>{const f=T("el-input"),m=T("el-form-item"),g=T("el-form"),A=T("Dialog");return C(),Q(A,{show:d.value.show,title:d.value.title,buttons:d.value.buttons,width:"400px",showCancel:!1,onClose:c[3]||(c[3]=b=>d.value.show=!1)},{default:E(()=>[k(g,{model:i.value,rules:u,ref_key:"formDataRef",ref:a,"label-width":"80px",onSubmit:c[2]||(c[2]=lt(()=>{},["prevent"]))},{default:E(()=>[k(m,{label:"新密码",prop:"password"},{default:E(()=>[k(f,{clearable:"",placeholder:"请输入密码",modelValue:i.value.password,"onUpdate:modelValue":c[0]||(c[0]=b=>i.value.password=b),modelModifiers:{trim:!0},size:"large","show-password":""},{prefix:E(()=>[gt]),_:1},8,["modelValue"])]),_:1}),k(m,{label:"确认密码",prop:"rePassword"},{default:E(()=>[k(f,{clearable:"",placeholder:"请再次输入密码",modelValue:i.value.rePassword,"onUpdate:modelValue":c[1]||(c[1]=b=>i.value.rePassword=b),modelModifiers:{trim:!0},size:"large","show-password":""},{prefix:E(()=>[_t]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])}}},Je="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Xe="ARRAYBUFFER not supported by this environment",qe="UINT8ARRAY not supported by this environment";function Ee(n,e,s,t){let o,a,i;const d=e||[0],u=(s=s||0)>>>3,h=t===-1?3:0;for(o=0;o<n.length;o+=1)i=o+u,a=i>>>2,d.length<=a&&d.push(0),d[a]|=n[o]<<8*(h+t*(i%4));return{value:d,binLen:8*n.length+s}}function ie(n,e,s){switch(e){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(n){case"HEX":return function(t,o,a){return function(i,d,u,h){let p,r,c,f;if(i.length%2!=0)throw new Error("String of HEX type must be in byte increments");const m=d||[0],g=(u=u||0)>>>3,A=h===-1?3:0;for(p=0;p<i.length;p+=2){if(r=parseInt(i.substr(p,2),16),isNaN(r))throw new Error("String of HEX type contains invalid characters");for(f=(p>>>1)+g,c=f>>>2;m.length<=c;)m.push(0);m[c]|=r<<8*(A+h*(f%4))}return{value:m,binLen:4*i.length+u}}(t,o,a,s)};case"TEXT":return function(t,o,a){return function(i,d,u,h,p){let r,c,f,m,g,A,b,U,v=0;const N=u||[0],_=(h=h||0)>>>3;if(d==="UTF8")for(b=p===-1?3:0,f=0;f<i.length;f+=1)for(r=i.charCodeAt(f),c=[],128>r?c.push(r):2048>r?(c.push(192|r>>>6),c.push(128|63&r)):55296>r||57344<=r?c.push(224|r>>>12,128|r>>>6&63,128|63&r):(f+=1,r=65536+((1023&r)<<10|1023&i.charCodeAt(f)),c.push(240|r>>>18,128|r>>>12&63,128|r>>>6&63,128|63&r)),m=0;m<c.length;m+=1){for(A=v+_,g=A>>>2;N.length<=g;)N.push(0);N[g]|=c[m]<<8*(b+p*(A%4)),v+=1}else for(b=p===-1?2:0,U=d==="UTF16LE"&&p!==1||d!=="UTF16LE"&&p===1,f=0;f<i.length;f+=1){for(r=i.charCodeAt(f),U===!0&&(m=255&r,r=m<<8|r>>>8),A=v+_,g=A>>>2;N.length<=g;)N.push(0);N[g]|=r<<8*(b+p*(A%4)),v+=2}return{value:N,binLen:8*v+h}}(t,e,o,a,s)};case"B64":return function(t,o,a){return function(i,d,u,h){let p,r,c,f,m,g,A,b=0;const U=d||[0],v=(u=u||0)>>>3,N=h===-1?3:0,_=i.indexOf("=");if(i.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(i=i.replace(/=/g,""),_!==-1&&_<i.length)throw new Error("Invalid '=' found in base-64 string");for(r=0;r<i.length;r+=4){for(m=i.substr(r,4),f=0,c=0;c<m.length;c+=1)p=Je.indexOf(m.charAt(c)),f|=p<<18-6*c;for(c=0;c<m.length-1;c+=1){for(A=b+v,g=A>>>2;U.length<=g;)U.push(0);U[g]|=(f>>>16-8*c&255)<<8*(N+h*(A%4)),b+=1}}return{value:U,binLen:8*b+u}}(t,o,a,s)};case"BYTES":return function(t,o,a){return function(i,d,u,h){let p,r,c,f;const m=d||[0],g=(u=u||0)>>>3,A=h===-1?3:0;for(r=0;r<i.length;r+=1)p=i.charCodeAt(r),f=r+g,c=f>>>2,m.length<=c&&m.push(0),m[c]|=p<<8*(A+h*(f%4));return{value:m,binLen:8*i.length+u}}(t,o,a,s)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(Xe)}return function(t,o,a){return function(i,d,u,h){return Ee(new Uint8Array(i),d,u,h)}(t,o,a,s)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(qe)}return function(t,o,a){return Ee(t,o,a,s)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function Fe(n,e,s,t){switch(n){case"HEX":return function(o){return function(a,i,d,u){const h="0123456789abcdef";let p,r,c="";const f=i/8,m=d===-1?3:0;for(p=0;p<f;p+=1)r=a[p>>>2]>>>8*(m+d*(p%4)),c+=h.charAt(r>>>4&15)+h.charAt(15&r);return u.outputUpper?c.toUpperCase():c}(o,e,s,t)};case"B64":return function(o){return function(a,i,d,u){let h,p,r,c,f,m="";const g=i/8,A=d===-1?3:0;for(h=0;h<g;h+=3)for(c=h+1<g?a[h+1>>>2]:0,f=h+2<g?a[h+2>>>2]:0,r=(a[h>>>2]>>>8*(A+d*(h%4))&255)<<16|(c>>>8*(A+d*((h+1)%4))&255)<<8|f>>>8*(A+d*((h+2)%4))&255,p=0;p<4;p+=1)m+=8*h+6*p<=i?Je.charAt(r>>>6*(3-p)&63):u.b64Pad;return m}(o,e,s,t)};case"BYTES":return function(o){return function(a,i,d){let u,h,p="";const r=i/8,c=d===-1?3:0;for(u=0;u<r;u+=1)h=a[u>>>2]>>>8*(c+d*(u%4))&255,p+=String.fromCharCode(h);return p}(o,e,s)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(Xe)}return function(o){return function(a,i,d){let u;const h=i/8,p=new ArrayBuffer(h),r=new Uint8Array(p),c=d===-1?3:0;for(u=0;u<h;u+=1)r[u]=a[u>>>2]>>>8*(c+d*(u%4))&255;return p}(o,e,s)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(qe)}return function(o){return function(a,i,d){let u;const h=i/8,p=d===-1?3:0,r=new Uint8Array(h);for(u=0;u<h;u+=1)r[u]=a[u>>>2]>>>8*(p+d*(u%4))&255;return r}(o,e,s)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const ce=4294967296,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],G=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],Z=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],he="Chosen SHA variant is not supported",je="Cannot set numRounds with MAC";function me(n,e){let s,t;const o=n.binLen>>>3,a=e.binLen>>>3,i=o<<3,d=4-o<<3;if(o%4!=0){for(s=0;s<a;s+=4)t=o+s>>>2,n.value[t]|=e.value[s>>>2]<<i,n.value.push(0),n.value[t+1]|=e.value[s>>>2]>>>d;return(n.value.length<<2)-4>=a+o&&n.value.pop(),{value:n.value,binLen:n.binLen+e.binLen}}return{value:n.value.concat(e.value),binLen:n.binLen+e.binLen}}function Le(n){const e={outputUpper:!1,b64Pad:"=",outputLen:-1},s=n||{},t="Output length must be a multiple of 8";if(e.outputUpper=s.outputUpper||!1,s.b64Pad&&(e.b64Pad=s.b64Pad),s.outputLen){if(s.outputLen%8!=0)throw new Error(t);e.outputLen=s.outputLen}else if(s.shakeLen){if(s.shakeLen%8!=0)throw new Error(t);e.outputLen=s.shakeLen}if(typeof e.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof e.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return e}function te(n,e,s,t){const o=n+" must include a value and format";if(!e){if(!t)throw new Error(o);return t}if(e.value===void 0||!e.format)throw new Error(o);return ie(e.format,e.encoding||"UTF8",s)(e.value)}class ge{constructor(e,s,t){const o=t||{};if(this.t=s,this.i=o.encoding||"UTF8",this.numRounds=o.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=e,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(e){let s,t=0;const o=this.m>>>5,a=this.C(e,this.h,this.u),i=a.binLen,d=a.value,u=i>>>5;for(s=0;s<u;s+=o)t+this.m<=i&&(this.U=this.v(d.slice(s,s+o),this.U),t+=this.m);return this.A+=t,this.h=d.slice(t>>>5),this.u=i%this.m,this.l=!0,this}getHash(e,s){let t,o,a=this.R;const i=Le(s);if(this.K){if(i.outputLen===-1)throw new Error("Output length must be specified in options");a=i.outputLen}const d=Fe(e,a,this.T,i);if(this.H&&this.g)return d(this.g(i));for(o=this.F(this.h.slice(),this.u,this.A,this.L(this.U),a),t=1;t<this.numRounds;t+=1)this.K&&a%32!=0&&(o[o.length-1]&=16777215>>>24-a%32),o=this.F(o,a,0,this.B(this.o),a);return d(o)}setHMACKey(e,s,t){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const o=ie(s,(t||{}).encoding||"UTF8",this.T);this.k(o(e))}k(e){const s=this.m>>>3,t=s/4-1;let o;if(this.numRounds!==1)throw new Error(je);if(this.H)throw new Error("MAC key already set");for(s<e.binLen/8&&(e.value=this.F(e.value,e.binLen,0,this.B(this.o),this.R));e.value.length<=t;)e.value.push(0);for(o=0;o<=t;o+=1)this.S[o]=909522486^e.value[o],this.p[o]=1549556828^e.value[o];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(e,s){const t=Le(s);return Fe(e,this.R,this.T,t)(this.Y())}Y(){let e;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");const s=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return e=this.v(this.p,this.B(this.o)),e=this.F(s,this.R,this.m,e,this.R),e}}function oe(n,e){return n<<e|n>>>32-e}function J(n,e){return n>>>e|n<<32-e}function Ge(n,e){return n>>>e}function He(n,e,s){return n^e^s}function Ze(n,e,s){return n&e^~n&s}function Qe(n,e,s){return n&e^n&s^e&s}function yt(n){return J(n,2)^J(n,13)^J(n,22)}function P(n,e){const s=(65535&n)+(65535&e);return(65535&(n>>>16)+(e>>>16)+(s>>>16))<<16|65535&s}function At(n,e,s,t){const o=(65535&n)+(65535&e)+(65535&s)+(65535&t);return(65535&(n>>>16)+(e>>>16)+(s>>>16)+(t>>>16)+(o>>>16))<<16|65535&o}function ue(n,e,s,t,o){const a=(65535&n)+(65535&e)+(65535&s)+(65535&t)+(65535&o);return(65535&(n>>>16)+(e>>>16)+(s>>>16)+(t>>>16)+(o>>>16)+(a>>>16))<<16|65535&a}function Nt(n){return J(n,7)^J(n,18)^Ge(n,3)}function St(n){return J(n,6)^J(n,11)^J(n,25)}function bt(n){return[1732584193,4023233417,2562383102,271733878,3285377520]}function We(n,e){let s,t,o,a,i,d,u;const h=[];for(s=e[0],t=e[1],o=e[2],a=e[3],i=e[4],u=0;u<80;u+=1)h[u]=u<16?n[u]:oe(h[u-3]^h[u-8]^h[u-14]^h[u-16],1),d=u<20?ue(oe(s,5),Ze(t,o,a),i,1518500249,h[u]):u<40?ue(oe(s,5),He(t,o,a),i,1859775393,h[u]):u<60?ue(oe(s,5),Qe(t,o,a),i,2400959708,h[u]):ue(oe(s,5),He(t,o,a),i,3395469782,h[u]),i=a,a=o,o=oe(t,30),t=s,s=d;return e[0]=P(s,e[0]),e[1]=P(t,e[1]),e[2]=P(o,e[2]),e[3]=P(a,e[3]),e[4]=P(i,e[4]),e}function kt(n,e,s,t){let o;const a=15+(e+65>>>9<<4),i=e+s;for(;n.length<=a;)n.push(0);for(n[e>>>5]|=128<<24-e%32,n[a]=4294967295&i,n[a-1]=i/ce|0,o=0;o<n.length;o+=16)t=We(n.slice(o,o+16),t);return t}let Ct=class extends ge{constructor(n,e,s){if(n!=="SHA-1")throw new Error(he);super(n,e,s);const t=s||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=ie(this.t,this.i,this.T),this.v=We,this.L=function(o){return o.slice()},this.B=bt,this.F=kt,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,t.hmacKey&&this.k(te("hmacKey",t.hmacKey,this.T))}};function Te(n){let e;return e=n=="SHA-224"?G.slice():Z.slice(),e}function Me(n,e){let s,t,o,a,i,d,u,h,p,r,c;const f=[];for(s=e[0],t=e[1],o=e[2],a=e[3],i=e[4],d=e[5],u=e[6],h=e[7],c=0;c<64;c+=1)f[c]=c<16?n[c]:At(J(m=f[c-2],17)^J(m,19)^Ge(m,10),f[c-7],Nt(f[c-15]),f[c-16]),p=ue(h,St(i),Ze(i,d,u),w[c],f[c]),r=P(yt(s),Qe(s,t,o)),h=u,u=d,d=i,i=P(a,p),a=o,o=t,t=s,s=P(p,r);var m;return e[0]=P(s,e[0]),e[1]=P(t,e[1]),e[2]=P(o,e[2]),e[3]=P(a,e[3]),e[4]=P(i,e[4]),e[5]=P(d,e[5]),e[6]=P(u,e[6]),e[7]=P(h,e[7]),e}let Ut=class extends ge{constructor(n,e,s){if(n!=="SHA-224"&&n!=="SHA-256")throw new Error(he);super(n,e,s);const t=s||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=ie(this.t,this.i,this.T),this.v=Me,this.L=function(o){return o.slice()},this.B=Te,this.F=function(o,a,i,d){return function(u,h,p,r,c){let f,m;const g=15+(h+65>>>9<<4),A=h+p;for(;u.length<=g;)u.push(0);for(u[h>>>5]|=128<<24-h%32,u[g]=4294967295&A,u[g-1]=A/ce|0,f=0;f<u.length;f+=16)r=Me(u.slice(f,f+16),r);return m=c==="SHA-224"?[r[0],r[1],r[2],r[3],r[4],r[5],r[6]]:r,m}(o,a,i,d,n)},this.U=Te(n),this.m=512,this.R=n==="SHA-224"?224:256,this.K=!1,t.hmacKey&&this.k(te("hmacKey",t.hmacKey,this.T))}};class l{constructor(e,s){this.N=e,this.I=s}}function Pe(n,e){let s;return e>32?(s=64-e,new l(n.I<<e|n.N>>>s,n.N<<e|n.I>>>s)):e!==0?(s=32-e,new l(n.N<<e|n.I>>>s,n.I<<e|n.N>>>s)):n}function X(n,e){let s;return e<32?(s=32-e,new l(n.N>>>e|n.I<<s,n.I>>>e|n.N<<s)):(s=64-e,new l(n.I>>>e|n.N<<s,n.N>>>e|n.I<<s))}function et(n,e){return new l(n.N>>>e,n.I>>>e|n.N<<32-e)}function Rt(n,e,s){return new l(n.N&e.N^n.N&s.N^e.N&s.N,n.I&e.I^n.I&s.I^e.I&s.I)}function Et(n){const e=X(n,28),s=X(n,34),t=X(n,39);return new l(e.N^s.N^t.N,e.I^s.I^t.I)}function D(n,e){let s,t;s=(65535&n.I)+(65535&e.I),t=(n.I>>>16)+(e.I>>>16)+(s>>>16);const o=(65535&t)<<16|65535&s;return s=(65535&n.N)+(65535&e.N)+(t>>>16),t=(n.N>>>16)+(e.N>>>16)+(s>>>16),new l((65535&t)<<16|65535&s,o)}function Ft(n,e,s,t){let o,a;o=(65535&n.I)+(65535&e.I)+(65535&s.I)+(65535&t.I),a=(n.I>>>16)+(e.I>>>16)+(s.I>>>16)+(t.I>>>16)+(o>>>16);const i=(65535&a)<<16|65535&o;return o=(65535&n.N)+(65535&e.N)+(65535&s.N)+(65535&t.N)+(a>>>16),a=(n.N>>>16)+(e.N>>>16)+(s.N>>>16)+(t.N>>>16)+(o>>>16),new l((65535&a)<<16|65535&o,i)}function Lt(n,e,s,t,o){let a,i;a=(65535&n.I)+(65535&e.I)+(65535&s.I)+(65535&t.I)+(65535&o.I),i=(n.I>>>16)+(e.I>>>16)+(s.I>>>16)+(t.I>>>16)+(o.I>>>16)+(a>>>16);const d=(65535&i)<<16|65535&a;return a=(65535&n.N)+(65535&e.N)+(65535&s.N)+(65535&t.N)+(65535&o.N)+(i>>>16),i=(n.N>>>16)+(e.N>>>16)+(s.N>>>16)+(t.N>>>16)+(o.N>>>16)+(a>>>16),new l((65535&i)<<16|65535&a,d)}function re(n,e){return new l(n.N^e.N,n.I^e.I)}function Ht(n){const e=X(n,19),s=X(n,61),t=et(n,6);return new l(e.N^s.N^t.N,e.I^s.I^t.I)}function Tt(n){const e=X(n,1),s=X(n,8),t=et(n,7);return new l(e.N^s.N^t.N,e.I^s.I^t.I)}function Mt(n){const e=X(n,14),s=X(n,18),t=X(n,41);return new l(e.N^s.N^t.N,e.I^s.I^t.I)}const Pt=[new l(w[0],3609767458),new l(w[1],602891725),new l(w[2],3964484399),new l(w[3],2173295548),new l(w[4],4081628472),new l(w[5],3053834265),new l(w[6],2937671579),new l(w[7],3664609560),new l(w[8],2734883394),new l(w[9],1164996542),new l(w[10],1323610764),new l(w[11],3590304994),new l(w[12],4068182383),new l(w[13],991336113),new l(w[14],633803317),new l(w[15],3479774868),new l(w[16],2666613458),new l(w[17],944711139),new l(w[18],2341262773),new l(w[19],2007800933),new l(w[20],1495990901),new l(w[21],1856431235),new l(w[22],3175218132),new l(w[23],2198950837),new l(w[24],3999719339),new l(w[25],766784016),new l(w[26],2566594879),new l(w[27],3203337956),new l(w[28],1034457026),new l(w[29],2466948901),new l(w[30],3758326383),new l(w[31],168717936),new l(w[32],1188179964),new l(w[33],1546045734),new l(w[34],1522805485),new l(w[35],2643833823),new l(w[36],2343527390),new l(w[37],1014477480),new l(w[38],1206759142),new l(w[39],344077627),new l(w[40],1290863460),new l(w[41],3158454273),new l(w[42],3505952657),new l(w[43],106217008),new l(w[44],3606008344),new l(w[45],1432725776),new l(w[46],1467031594),new l(w[47],851169720),new l(w[48],3100823752),new l(w[49],1363258195),new l(w[50],3750685593),new l(w[51],3785050280),new l(w[52],3318307427),new l(w[53],3812723403),new l(w[54],2003034995),new l(w[55],3602036899),new l(w[56],1575990012),new l(w[57],1125592928),new l(w[58],2716904306),new l(w[59],442776044),new l(w[60],593698344),new l(w[61],3733110249),new l(w[62],2999351573),new l(w[63],3815920427),new l(3391569614,3928383900),new l(3515267271,566280711),new l(3940187606,3454069534),new l(4118630271,4000239992),new l(116418474,1914138554),new l(174292421,2731055270),new l(289380356,3203993006),new l(460393269,320620315),new l(685471733,587496836),new l(852142971,1086792851),new l(1017036298,365543100),new l(1126000580,2618297676),new l(1288033470,3409855158),new l(1501505948,4234509866),new l(1607167915,987167468),new l(1816402316,1246189591)];function Ke(n){return n==="SHA-384"?[new l(3418070365,G[0]),new l(1654270250,G[1]),new l(2438529370,G[2]),new l(355462360,G[3]),new l(1731405415,G[4]),new l(41048885895,G[5]),new l(3675008525,G[6]),new l(1203062813,G[7])]:[new l(Z[0],4089235720),new l(Z[1],2227873595),new l(Z[2],4271175723),new l(Z[3],1595750129),new l(Z[4],2917565137),new l(Z[5],725511199),new l(Z[6],4215389547),new l(Z[7],327033209)]}function xe(n,e){let s,t,o,a,i,d,u,h,p,r,c,f;const m=[];for(s=e[0],t=e[1],o=e[2],a=e[3],i=e[4],d=e[5],u=e[6],h=e[7],c=0;c<80;c+=1)c<16?(f=2*c,m[c]=new l(n[f],n[f+1])):m[c]=Ft(Ht(m[c-2]),m[c-7],Tt(m[c-15]),m[c-16]),p=Lt(h,Mt(i),(A=d,b=u,new l((g=i).N&A.N^~g.N&b.N,g.I&A.I^~g.I&b.I)),Pt[c],m[c]),r=D(Et(s),Rt(s,t,o)),h=u,u=d,d=i,i=D(a,p),a=o,o=t,t=s,s=D(p,r);var g,A,b;return e[0]=D(s,e[0]),e[1]=D(t,e[1]),e[2]=D(o,e[2]),e[3]=D(a,e[3]),e[4]=D(i,e[4]),e[5]=D(d,e[5]),e[6]=D(u,e[6]),e[7]=D(h,e[7]),e}let Kt=class extends ge{constructor(n,e,s){if(n!=="SHA-384"&&n!=="SHA-512")throw new Error(he);super(n,e,s);const t=s||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=ie(this.t,this.i,this.T),this.v=xe,this.L=function(o){return o.slice()},this.B=Ke,this.F=function(o,a,i,d){return function(u,h,p,r,c){let f,m;const g=31+(h+129>>>10<<5),A=h+p;for(;u.length<=g;)u.push(0);for(u[h>>>5]|=128<<24-h%32,u[g]=4294967295&A,u[g-1]=A/ce|0,f=0;f<u.length;f+=32)r=xe(u.slice(f,f+32),r);return m=c==="SHA-384"?[r[0].N,r[0].I,r[1].N,r[1].I,r[2].N,r[2].I,r[3].N,r[3].I,r[4].N,r[4].I,r[5].N,r[5].I]:[r[0].N,r[0].I,r[1].N,r[1].I,r[2].N,r[2].I,r[3].N,r[3].I,r[4].N,r[4].I,r[5].N,r[5].I,r[6].N,r[6].I,r[7].N,r[7].I],m}(o,a,i,d,n)},this.U=Ke(n),this.m=1024,this.R=n==="SHA-384"?384:512,this.K=!1,t.hmacKey&&this.k(te("hmacKey",t.hmacKey,this.T))}};const xt=[new l(0,1),new l(0,32898),new l(2147483648,32906),new l(2147483648,2147516416),new l(0,32907),new l(0,2147483649),new l(2147483648,2147516545),new l(2147483648,32777),new l(0,138),new l(0,136),new l(0,2147516425),new l(0,2147483658),new l(0,2147516555),new l(2147483648,139),new l(2147483648,32905),new l(2147483648,32771),new l(2147483648,32770),new l(2147483648,128),new l(0,32778),new l(2147483648,2147483658),new l(2147483648,2147516545),new l(2147483648,32896),new l(0,2147483649),new l(2147483648,2147516424)],$t=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function Ne(n){let e;const s=[];for(e=0;e<5;e+=1)s[e]=[new l(0,0),new l(0,0),new l(0,0),new l(0,0),new l(0,0)];return s}function zt(n){let e;const s=[];for(e=0;e<5;e+=1)s[e]=n[e].slice();return s}function fe(n,e){let s,t,o,a;const i=[],d=[];if(n!==null)for(t=0;t<n.length;t+=2)e[(t>>>1)%5][(t>>>1)/5|0]=re(e[(t>>>1)%5][(t>>>1)/5|0],new l(n[t+1],n[t]));for(s=0;s<24;s+=1){for(a=Ne(),t=0;t<5;t+=1)i[t]=(u=e[t][0],h=e[t][1],p=e[t][2],r=e[t][3],c=e[t][4],new l(u.N^h.N^p.N^r.N^c.N,u.I^h.I^p.I^r.I^c.I));for(t=0;t<5;t+=1)d[t]=re(i[(t+4)%5],Pe(i[(t+1)%5],1));for(t=0;t<5;t+=1)for(o=0;o<5;o+=1)e[t][o]=re(e[t][o],d[t]);for(t=0;t<5;t+=1)for(o=0;o<5;o+=1)a[o][(2*t+3*o)%5]=Pe(e[t][o],$t[t][o]);for(t=0;t<5;t+=1)for(o=0;o<5;o+=1)e[t][o]=re(a[t][o],new l(~a[(t+1)%5][o].N&a[(t+2)%5][o].N,~a[(t+1)%5][o].I&a[(t+2)%5][o].I));e[0][0]=re(e[0][0],xt[s])}var u,h,p,r,c;return e}function tt(n){let e,s,t=0;const o=[0,0],a=[4294967295&n,n/ce&2097151];for(e=6;e>=0;e--)s=a[e>>2]>>>8*e&255,s===0&&t===0||(o[t+1>>2]|=s<<8*(t+1),t+=1);return t=t!==0?t:1,o[0]|=t,{value:t+1>4?o:[o[0]],binLen:8+8*t}}function ye(n){return me(tt(n.binLen),n)}function $e(n,e){let s,t=tt(e);t=me(t,n);const o=e>>>2,a=(o-t.value.length%o)%o;for(s=0;s<a;s++)t.value.push(0);return t.value}let Bt=class extends ge{constructor(n,e,s){let t=6,o=0;super(n,e,s);const a=s||{};if(this.numRounds!==1){if(a.kmacKey||a.hmacKey)throw new Error(je);if(this.o==="CSHAKE128"||this.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=ie(this.t,this.i,this.T),this.v=fe,this.L=zt,this.B=Ne,this.U=Ne(),this.K=!1,n){case"SHA3-224":this.m=o=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=o=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=o=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=o=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":t=31,this.m=o=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":t=31,this.m=o=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":t=4,this.m=o=1344,this.X(s),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":t=4,this.m=o=1088,this.X(s),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=o=1344,t=this.O(s),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=o=1088,t=this.O(s),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(he)}this.F=function(i,d,u,h,p){return function(r,c,f,m,g,A,b){let U,v,N=0;const _=[],F=g>>>5,L=c>>>5;for(U=0;U<L&&c>=g;U+=F)m=fe(r.slice(U,U+F),m),c-=g;for(r=r.slice(U),c%=g;r.length<F;)r.push(0);for(U=c>>>3,r[U>>2]^=A<<U%4*8,r[F-1]^=2147483648,m=fe(r,m);32*_.length<b&&(v=m[N%5][N/5|0],_.push(v.I),!(32*_.length>=b));)_.push(v.N),N+=1,64*N%g==0&&(fe(null,m),N=0);return _}(i,d,0,h,o,t,p)},a.hmacKey&&this.k(te("hmacKey",a.hmacKey,this.T))}O(n,e){const s=function(o){const a=o||{};return{funcName:te("funcName",a.funcName,1,{value:[],binLen:0}),customization:te("Customization",a.customization,1,{value:[],binLen:0})}}(n||{});e&&(s.funcName=e);const t=me(ye(s.funcName),ye(s.customization));if(s.customization.binLen!==0||s.funcName.binLen!==0){const o=$e(t,this.m>>>3);for(let a=0;a<o.length;a+=this.m>>>5)this.U=this.v(o.slice(a,a+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(n){const e=function(t){const o=t||{};return{kmacKey:te("kmacKey",o.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:te("Customization",o.customization,1,{value:[],binLen:0})}}(n||{});this.O(n,e.funcName);const s=$e(ye(e.kmacKey),this.m>>>3);for(let t=0;t<s.length;t+=this.m>>>5)this.U=this.v(s.slice(t,t+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(n){const e=me({value:this.h.slice(),binLen:this.u},function(s){let t,o,a=0;const i=[0,0],d=[4294967295&s,s/ce&2097151];for(t=6;t>=0;t--)o=d[t>>2]>>>8*t&255,o===0&&a===0||(i[a>>2]|=o<<8*a,a+=1);return a=a!==0?a:1,i[a>>2]|=a<<8*a,{value:a+1>4?i:[i[0]],binLen:8+8*a}}(n.outputLen));return this.F(e.value,e.binLen,this.A,this.L(this.U),n.outputLen)}};class Ot{constructor(e,s,t){if(e=="SHA-1")this.P=new Ct(e,s,t);else if(e=="SHA-224"||e=="SHA-256")this.P=new Ut(e,s,t);else if(e=="SHA-384"||e=="SHA-512")this.P=new Kt(e,s,t);else{if(e!="SHA3-224"&&e!="SHA3-256"&&e!="SHA3-384"&&e!="SHA3-512"&&e!="SHAKE128"&&e!="SHAKE256"&&e!="CSHAKE128"&&e!="CSHAKE256"&&e!="KMAC128"&&e!="KMAC256")throw new Error(he);this.P=new Bt(e,s,t)}}update(e){return this.P.update(e),this}getHash(e,s){return this.P.getHash(e,s)}setHMACKey(e,s,t){this.P.setHMACKey(e,s,t)}getHMAC(e,s){return this.P.getHMAC(e,s)}}const be=n=>(Ye("data-v-d71bf299"),n=n(),Ve(),n),Dt={class:"uploader-panel"},Yt={class:"uploader-title"},Vt=be(()=>I("span",null,"上传任务",-1)),Jt=be(()=>I("span",{class:"tips"},"（仅展示本次上传任务）",-1)),Xt=be(()=>I("span",{class:"iconfont icon-del m-right"},null,-1)),qt={class:"file-list"},jt={class:"upload-panel"},Gt={class:"file-name"},Zt={class:"progress"},Qt={class:"upload-status"},Wt={key:0,class:"upload-info"},es={class:"op"},ts={class:"op-btn"},ss={key:0},ns={key:0},j=1024*1024*5,os={__name:"Uploader",emits:["uploadCallback"],setup(n,{expose:e,emit:s}){const{proxy:t}=ve(),o={upload:"/file/uploadFile"},a=R([]),i={emptyfile:{value:"emptyfile",desc:"文件为空",color:"#F75000",icon:"close"},fail:{value:"fail",desc:"上传失败",color:"#F75000",icon:"close"},init:{value:"init",desc:"解析中",color:"#e6a23c",icon:"clock"},uploading:{value:"uploading",desc:"上传中",color:"#409eff",icon:"upload"},upload_finish:{value:"upload_finish",desc:"上传完成",color:"#67c23a",icon:"ok"},upload_seconds:{value:"upload_seconds",desc:"秒传",color:"#67c23a",icon:"ok"}},d=R([]),u=async v=>{let N=v.file,_=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,F=Math.ceil(N.size/j),L=0,q=new Ot("SHA3-256","TEXT"),y=new FileReader,B=()=>{let H=L*j,ne=H+j>=N.size?N.size:H+j;y.readAsArrayBuffer(_.call(N,H,ne))};return B(),new Promise((H,ne)=>{let z=h(N.uid);z.md5Progress=0,y.onload=V=>{if(q.update(new Int8Array(V.target.result).join("")),L++,L<F){let x=Math.floor(L/F*100);z.md5Progress=x,B()}else{let x=q.getHash("HEX");z.md5Progress=100,z.status=i.uploading.value,z.md5=x,H(v.uid)}},y.onerror=V=>{z.md5Progress=-1,z.status=i.fail.value,H(v.uid)}}).catch(H=>(console.error(H),null))},h=v=>a.value.find(_=>_.file.uid===v),p=(v,N)=>{for(let _=0;_<a.value.length;_++)if(a.value[_].file.uid===v){Object.assign(a.value[_],N);break}},r=v=>{p(v,{pause:!1}),U(v,h(v).chunkIndex),localStorage.setItem("filelist",JSON.stringify(a.value))},c=v=>{p(v,{pause:!0}),localStorage.setItem("filelist",JSON.stringify(a.value))},f=()=>{a.value=[],localStorage.setItem("filelist",JSON.stringify(a.value))},m=(v,N)=>{a.value.splice(N,1),localStorage.setItem("filelist",JSON.stringify(a.value))},g=(v,N)=>{a.value.splice(N,1),localStorage.setItem("filelist",JSON.stringify(a.value))};De(()=>{let v=localStorage.getItem("filelist");v&&(a.value=JSON.parse(v))});const A=s;e({addFile:async(v,N)=>{const _={file:v,uid:v.uid,md5Progress:0,md5:null,fileName:v.name,status:i.init.value,uploadSize:0,totalSize:v.size,uploadProgress:0,pause:!1,chunkIndex:0,filePid:N,errorMsg:null,type:v.type};if(a.value.unshift(_),_.totalSize==0){_.status=i.emptyfile.value,localStorage.setItem("filelist",JSON.stringify(a.value));return}let F=await u(_);F!=null&&U(F)}});const U=async(v,N)=>{N=N||0;let _=h(v),F=_.file;if(!F.name)try{F=await t.IdbFileTool.getFile(v)}catch(y){t.Message.error(y);return}const L=_.totalSize,q=Math.ceil(L/j);for(let y=N;y<q;y++){let B=d.value.indexOf(v);if(B!=-1){d.value.slice(B,1);break}if(_.pause){p(v,{chunkIndex:y}),t.IdbFileTool.saveFile(F,v),localStorage.setItem("filelist",JSON.stringify(a.value));return}let H=y*j,ne=H+j>=L?L:H+j,z=F.slice(H,ne),V=await t.Request({url:o.upload,showLoading:!1,dataType:"file",params:{file:z,fileName:F.name,fileMd5:_.md5,chunkIndex:y,chunks:q,fileId:_.fileId,filePid:_.filePid},showError:!1,errorCallback:x=>{_.status=i.fail.value,_.errorMsg=x},onUploadProgressCallback:x=>{let S=x.loaded;S>L&&(S=L),_.uploadSize=y*j+S,_.uploadProgress=Math.floor(_.uploadSize/L*100)}});if(V==null)break;if(_.fileId=V.fileId,_.status=i[V.status].value,_.chunkIndex=y,V.status==i.upload_seconds.value||V.status==i.upload_finish.value){t.IdbFileTool.delFile(v),_.uploadProgress=100,A("uploadCallback");break}}localStorage.setItem("filelist",JSON.stringify(a.value))};return(v,N)=>{const _=T("el-button"),F=T("el-progress"),L=T("Icon"),q=T("NoData");return C(),K("div",Dt,[I("div",Yt,[Vt,Jt,k(_,{type:"danger",onClick:f,disabled:a.value.length==0},{default:E(()=>[Xt,ae(" 清空 ")]),_:1},8,["disabled"])]),I("div",qt,[(C(!0),K(pe,null,Ae(a.value,(y,B)=>(C(),K("div",{key:B,class:"file-item"},[I("div",jt,[I("div",Gt,Y(y.fileName),1),I("div",Zt,[y.status==i.uploading.value||y.status==i.upload_seconds.value||y.status==i.upload_finish.value?(C(),Q(F,{key:0,percentage:y.uploadProgress},null,8,["percentage"])):ee("",!0)]),I("div",Qt,[I("span",{class:se(["iconfont","icon-"+i[y.status].icon]),style:ke({color:i[y.status].color})},null,6),I("span",{class:"stauts",style:ke({color:i[y.status].color})},Y(y.status=="fail"?y.errorMsg:i[y.status].desc),5),y.status==i.uploading.value?(C(),K("span",Wt,Y(we(t).Utils.size2Str(y.uploadSize))+" / "+Y(we(t).Utils.size2Str(y.totalSize)),1)):ee("",!0)])]),I("div",es,[y.status==i.init.value?(C(),Q(F,{key:0,type:"circle",width:50,percentage:y.md5Progress},null,8,["percentage"])):ee("",!0),I("div",ts,[y.status==i.uploading.value?(C(),K("span",ss,[y.pause?(C(),Q(L,{key:0,width:28,class:"btn-item",iconName:"upload",title:"上传",onClick:H=>r(y.uid)},null,8,["onClick"])):(C(),Q(L,{key:1,width:28,class:"btn-item",iconName:"pause",title:"暂停",onClick:H=>c(y.uid)},null,8,["onClick"]))])):ee("",!0),y.status!=i.init.value&&y.status!=i.upload_finish.value&&y.status!=i.upload_seconds.value?(C(),Q(L,{key:1,width:28,class:"btn-item",iconName:"del",title:"删除",onClick:H=>m(y.uid,B)},null,8,["onClick"])):ee("",!0),y.status==i.upload_finish.value||y.status==i.upload_seconds.value?(C(),Q(L,{key:2,width:28,class:"btn-item",iconName:"clean",title:"清除",onClick:H=>g(y.uid,B)},null,8,["onClick"])):ee("",!0)])])]))),128)),a.value.length==0?(C(),K("div",ns,[k(q,{msg:"暂无上传任务"})])):ee("",!0)])])}}},as=Se(os,[["__scopeId","data-v-d71bf299"]]),_e=n=>(Ye("data-v-2c5f6958"),n=n(),Ve(),n),is=_e(()=>I("h2",null,"放入当前文件夹",-1)),ls=[is],rs={class:"header"},us=_e(()=>I("div",{class:"logo"},[I("span",{class:"iconfont icon-pan"}),I("div",{class:"name"},"My Pan")],-1)),cs={class:"right-panel"},hs=_e(()=>I("span",{class:"iconfont icon-transfer"},null,-1)),ds={class:"user-info"},fs={class:"avatar"},ps={class:"nickname"},ws={class:"body"},ms={class:"left-sider"},vs={class:"menu-list"},gs=["onClick"],_s={class:"text"},Is={class:"menu-sub-list"},ys=["onClick"],As={class:"text"},Ns={class:"space-info"},Ss=_e(()=>I("div",null,"空间使用",-1)),bs={class:"percent"},ks={class:"space-use"},Cs={class:"use"},Us={class:"body-content"},Rs={__name:"Layout",setup(n){const e=ze(),s=Be(),{proxy:t}=ve(),o={getUserInfo:"/getUserInfo",logout:"/logout",getUseSpace:"/getUseSpace"},a=R(0),i=R({}),d=R(!1),u=R([{icon:"cloude",name:"首页",menuCode:"main",path:"/main/all",allShow:!0,children:[{icon:"all",name:"全部",category:"all",path:"/main/all"},{icon:"video",name:"视频",category:"video",path:"/main/video"},{icon:"music",name:"音频",category:"music",path:"/main/music"},{icon:"image",name:"图片",category:"image",path:"/main/image"},{icon:"doc",name:"文档",category:"doc",path:"/main/doc"},{icon:"more",name:"其他",category:"other",path:"/main/others"}]},{path:"/myshare",icon:"share",name:"分享",menuCode:"share",allShow:!0,children:[{name:"分享记录",path:"/myshare"}]},{path:"/recycle",icon:"del",name:"回收站",menuCode:"recycle",tips:"回收站为您保存10天内删除的文件",allShow:!0,children:[{name:"回收站",path:"/recycle"}]}]),h=R({}),p=R(),r=R(!1),c=R(),f=R(),m=R(),g=R(null),A=R(),b=R({useSpace:0,totalSpace:1}),U=S=>{!S.path||S.menuCode==h.value.menuCode||e.push(S.path)},v=(S,$)=>{const O=u.value.find(W=>W.menuCode==S);h.value=O,p.value=$},N=()=>{let S=JSON.parse(sessionStorage.getItem("user"));S.avatar=null,i.value=S,a.value=new Date().getTime()},_=()=>{f.value.show(i.value)},F=()=>{m.value.show()},L=S=>{const{file:$,filePid:O,addFileCallback:W}=S;r.value=!0,c.value.addFile($,O),g.value=W},q=()=>{Oe(()=>{A.value.reload(),x()})},y=()=>{let S=JSON.parse(sessionStorage.getItem("user"));S&&S.isAdmin&&u.value.length==3&&u.value.push({path:"/settings/fileList",icon:"settings",name:"设置",menuCode:"settings",allShow:!0,children:[{name:"用户文件",path:"/settings/fileList"},{name:"用户管理",path:"/settings/userList"},{name:"系统管理",path:"/settings/sysSetting"}]})},B=S=>{S.preventDefault();const $=S.dataTransfer.items;for(const O of $){const W=O.getAsFile(),le=t.Utils.fileUid();W.uid=le;let de=O.webkitGetAsEntry();A.value.dropFile&&(de.isFile?A.value.dropFile(W):t.Confirm("你确定要上传文件夹以及其中所有的文件到当前目录吗？",()=>{A.value.dropFolder(de)}))}d.value=!1};let H=null;const ne=S=>{A.value.dropFile&&(S.preventDefault(),H&&clearTimeout(H),H=setTimeout(()=>{d.value=!1},1e3),d.value=!0)};De(async()=>{await z();let S=JSON.parse(sessionStorage.getItem("user"));S.avatar=null,i.value=S,y(),x()});const z=async()=>{sessionStorage.getItem("user");const S=await t.Request({url:o.getUserInfo,params:{}});S&&sessionStorage.setItem("user",JSON.stringify(S))},V=()=>{t.Confirm("您确定要退出吗？",async()=>{await t.Request({url:o.logout})&&(sessionStorage.clear(),t.LocalStorage.remove("loginInfo"),e.push("/login"))})},x=async()=>{let S=await t.Request({url:o.getUseSpace,showLoading:!1});S&&(b.value=S)};return rt(()=>s,async(S,$)=>{await x(),await z();let O=sessionStorage.getItem("user");O!=null&&O&&y(),S.meta.menuCode&&v(S.meta.menuCode,S.path)},{immediate:!0,deep:!0}),(S,$)=>{const O=T("el-popover"),W=T("Avatar"),le=T("el-dropdown-item"),de=T("el-dropdown-menu"),st=T("el-dropdown"),nt=T("el-progress"),ot=T("router-view");return C(),K("div",{class:"framework",onDrop:$[1]||($[1]=M=>B(M)),onDragover:$[2]||($[2]=M=>ne(M))},[I("div",{id:"mask",class:se(["mask",d.value?"show":""])},null,2),I("div",{id:"modal",class:se(["modal",d.value?"show":""])},ls,2),I("div",rs,[us,I("div",cs,[k(O,{width:800,trigger:"click",visible:r.value,"onUpdate:visible":$[0]||($[0]=M=>r.value=M),offset:20,transition:"none","hide-after":0,"popper-style":{padding:"0px"}},{reference:E(()=>[hs]),default:E(()=>[k(as,{ref_key:"uploaderRef",ref:c,onUploadCallback:q},null,512)]),_:1},8,["visible"]),k(st,null,{dropdown:E(()=>[k(de,null,{default:E(()=>[k(le,{onClick:_},{default:E(()=>[ae("修改头像")]),_:1}),k(le,{onClick:F},{default:E(()=>[ae("修改密码")]),_:1}),k(le,{onClick:V},{default:E(()=>[ae("退出登录")]),_:1})]),_:1})]),default:E(()=>[I("div",ds,[I("div",fs,[k(W,{userId:i.value.id,avatar:i.value.avatar,timestamp:a.value,width:46},null,8,["userId","avatar","timestamp"])]),I("span",ps,Y(i.value.nickName),1)])]),_:1})])]),I("div",ws,[I("div",ms,[I("div",vs,[(C(!0),K(pe,null,Ae(u.value,(M,Ie)=>(C(),K("div",{onClick:at=>U(M),class:se(["menu-item",M.menuCode==h.value.menuCode?"active":""]),key:Ie},[I("div",{class:se(["iconfont","icon-"+M.icon])},null,2),I("div",_s,Y(M.name),1)],10,gs))),128))]),I("div",Is,[(C(!0),K(pe,null,Ae(h.value.children,(M,Ie)=>(C(),K("div",{onClick:at=>U(M),class:se(["menu-item-sub",p.value==M.path?"active":""]),key:Ie},[Ce(I("span",{class:se(["iconfont","icon-"+M.icon])},null,2),[[Ue,M.icon]]),I("span",As,Y(M.name),1)],10,ys))),128)),Ce(I("div",{class:"tips"},Y(h.value.tips),513),[[Ue,h.value&&h.value.tips]]),I("div",Ns,[Ss,I("div",bs,[k(nt,{percentage:Math.floor(b.value.useSpace/b.value.totalSpace*1e4)/100,color:"#409eff"},null,8,["percentage"]),I("div",ks,[I("div",Cs,Y(we(t).Utils.size2Str(b.value.useSpace))+" / "+Y(we(t).Utils.size2Str(b.value.totalSpace)),1),I("div",{class:"iconfont icon-refresh",onClick:x})])])])])]),I("div",Us,[k(ot,null,{default:E(({Component:M})=>[(C(),Q(ut(M),{ref_key:"routerViewRef",ref:A,onAddFile:L,onReload:x},null,544))]),_:1})])]),k(vt,{ref_key:"updateAvatarRef",ref:f,onUpdateAvatar:N},null,512),k(It,{ref_key:"updatePasswordRef",ref:m},null,512)],32)}}},Ls=Se(Rs,[["__scopeId","data-v-2c5f6958"]]);export{Ls as default};
