import{_ as V,r as C,b as v,o,c as h,d as i,f as u,w as c,i as y,F as j,e as p,t as b,g as I,v as E,j as w,x as H,y as U}from"./index-B4Kzr3cv.js";const N=f=>(H("data-v-c498185c"),f=f(),U(),f),A={class:"top"},G=N(()=>i("span",null,"还原",-1)),J=N(()=>i("span",null,"批量删除",-1)),K={class:"file-list"},P=["onMouseenter","onMouseleave"],Q=["title"],W={class:"opt"},X=["title"],Y={key:0},Z={__name:"Recycle",emits:["reload"],setup(f,{emit:T}){const{proxy:s}=w(),F=[{label:"文件名",prop:"fileName",scopedSlots:"fileName"},{label:"删除时间",prop:"recoveryTime",width:200},{label:"大小",prop:"fileSize",scopedSlots:"fileSize",width:200}],r={loadDataList:"/recycle/loadRecycleList",delFile:"/recycle/delFile",recoverFile:"/recycle/recoverFile"},d=C({}),x={extHeight:20,selectType:"checkBox"},n=C([]),R=e=>{n.value=[],e.forEach(l=>{n.value.push(l.fileId)})},S=e=>{d.value.list.forEach(l=>{l.showOp=!1}),e.showOp=!0},z=e=>{e.showOp=!1},_=T,a=async()=>{let e={pageNo:d.value.pageNo||1,pageSize:d.value.pageSize||15},l=await s.Request({url:r.loadDataList,params:e});l&&(d.value=l)},M=e=>{s.Confirm(`你确定要还原【${e.fileName}】吗?`,async()=>{let l=await s.Request({url:r.recoverFile,params:{fileIds:e.fileId}});if(!l){a();return}s.Message.success(l),a(),_("reload")})},B=()=>{s.Confirm("你确定要还原这些文件吗?",async()=>{let e=await s.Request({url:r.recoverFile,params:{fileIds:n.value.join(",")}});if(!e){a();return}s.Message.success(e),a(),_("reload")})},O=e=>{s.Confirm(`你确定要删除【${e.fileName}】吗?`,async()=>{let l=await s.Request({url:r.delFile,params:{fileIds:e.fileId}});if(!l){a();return}s.Message.success(l),a(),_("reload")})},$=()=>{s.Confirm("你确定要删除这些文件吗?删除后无法恢复。",async()=>{let e=await s.Request({url:r.delFile,params:{fileIds:n.value.join(",")}});if(!e){a();return}s.Message.success(e),a(),_("reload")})};return(e,l)=>{const m=v("el-button"),g=v("Icon"),q=v("el-popover"),D=v("Table");return o(),h("div",null,[i("div",A,[u(m,{type:"success",class:"iconfont icon-revert",disabled:n.value.length==0,onClick:B},{default:c(()=>[G]),_:1},8,["disabled"]),u(m,{type:"danger",class:"iconfont icon-del",disabled:n.value.length==0,onClick:$},{default:c(()=>[J]),_:1},8,["disabled"])]),i("div",K,[u(D,{ref:"dataTableRef",columns:F,dataSource:d.value,fetch:a,initFetch:!0,options:x,onRowSelected:R},{fileName:c(({index:L,row:t})=>[i("div",{class:"file-item",onMouseenter:k=>S(t),onMouseleave:k=>z(t)},[t.fileType==3||t.fileType==1&&t.status!=0?(o(),y(g,{key:0,cover:t.fileCover},null,8,["cover"])):(o(),h(j,{key:1},[t.folderType==0?(o(),y(g,{key:0,fileType:t.fileType},null,8,["fileType"])):p("",!0),t.folderType==1?(o(),y(g,{key:1,fileType:0})):p("",!0)],64)),S?p("",!0):(o(),h("span",{key:2,class:"file-name",title:t.fileName},b(t.fileName),9,Q)),S?(o(),y(q,{key:3,placement:"left",width:20,trigger:"hover"},{reference:c(()=>[i("span",{class:"file-name",title:t.fileName},b(t.fileName),9,X)]),default:c(()=>[i("div",W,[u(m,{class:"iconfont icon-revert",onClick:k=>M(t)},{default:c(()=>[I("还原")]),_:2},1032,["onClick"]),u(m,{class:"iconfont icon-del",onClick:k=>O(t)},{default:c(()=>[I("删除")]),_:2},1032,["onClick"])])]),_:2},1024)):p("",!0)],40,P)]),fileSize:c(({index:L,row:t})=>[t.fileSize?(o(),h("span",Y,b(E(s).Utils.size2Str(t.fileSize)),1)):p("",!0)]),_:1},8,["dataSource"])])])}}},te=V(Z,[["__scopeId","data-v-c498185c"]]);export{te as default};
