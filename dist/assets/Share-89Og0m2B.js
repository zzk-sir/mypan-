import{_ as q,r as c,c as x,d as t,f as p,w as o,D as K,b as u,o as l,g as _,i as m,F as U,e as v,t as C,j as H,v as A,x as G}from"./index-CS92JP14.js";const J=d=>(A("data-v-95b28bf8"),d=d(),G(),d),P={class:"top"},Q={class:"top-op"},W=J(()=>t("span",{class:"iconfont icon-cancel"},null,-1)),X={class:"search-panel"},Y={class:"file-list"},Z=["onMouseenter","onMouseleave"],ee=["title"],ae={class:"opt"},te=["title"],se={__name:"Share",setup(d){const{proxy:n}=H(),M=[{label:"文件名",prop:"fileName",scopedSlots:"fileName"},{label:"分享时间",prop:"shareTime",width:200},{label:"失效时间",prop:"expireTime",scopedSlots:"expireTime",width:200},{label:"浏览次数",prop:"showCount",width:200}],N={loadDataList:"/share/loadDataList",cancelShare:"/share/cancelShare"},i=c([]),V=c(document.location.origin+"/shareCheck/"),r=c({}),$={extHeight:20,selectType:"checkBox"},h=c([]),y=c();c();const z=()=>{i.value.length!=0&&(h.value=i.value,console.log(h.value),I())},B=a=>{h.value=[a.shareId],I()},I=()=>{n.Confirm("你确定要取消分享吗?",async()=>{await n.Request({url:N.cancelShare,params:{shareIds:h.value.join(",")}})&&(n.Message.success("取消分享成功"),f())})},D=()=>{f()},L=a=>{i.value=[],a.forEach(s=>{i.value.push(s.shareId)})},S=a=>{r.value.list.forEach(s=>{s.showOp=!1}),a.showOp=!0},O=a=>{a.showOp=!1},w=async a=>{await navigator.clipboard.writeText(`${V.value}${a.shareId} 提取码：${a.code}`),n.Message.success("复制成功")},F=()=>{f()},f=async()=>{let a={pageNo:r.value.pageNo||1,pageSize:r.value.pageSize||15,fileNameFuzzy:y.value||""},s=await n.Request({url:N.loadDataList,params:a});s&&(r.value=s)};return(a,s)=>{const b=u("el-button"),R=u("el-input"),T=u("Icon"),E=u("el-popover"),j=u("Table");return l(),x("div",null,[t("div",P,[t("div",Q,[p(b,{type:"primary",disabled:i.value.length==0,onClick:z},{default:o(()=>[W,_(" 取消分享")]),_:1},8,["disabled"]),t("div",X,[p(R,{clearable:"",placeholder:"请输入分享文件名搜索",modelValue:y.value,"onUpdate:modelValue":s[0]||(s[0]=k=>y.value=k),modelModifiers:{trim:!0},onKeyup:K(D,["enter"])},{suffix:o(()=>[t("i",{class:"iconfont icon-search",onClick:D})]),_:1},8,["modelValue"])]),t("div",{class:"iconfont icon-refresh",onClick:F})]),t("div",Y,[p(j,{ref:"dataTableRef",columns:M,dataSource:r.value,fetch:f,initFetch:!0,options:$,onRowSelected:L},{fileName:o(({index:k,row:e})=>[t("div",{class:"file-item",onMouseenter:g=>S(e),onMouseleave:g=>O(e)},[e.fileType==3||e.fileType==1&&e.status!=0?(l(),m(T,{key:0,cover:e.fileCover},null,8,["cover"])):(l(),x(U,{key:1},[e.folderType==0?(l(),m(T,{key:0,fileType:e.fileType},null,8,["fileType"])):v("",!0),e.folderType==1?(l(),m(T,{key:1,fileType:0})):v("",!0)],64)),S?v("",!0):(l(),x("span",{key:2,class:"file-name",title:e.fileName},C(e.fileName),9,ee)),S?(l(),m(E,{key:3,placement:"left",width:20,trigger:"hover"},{reference:o(()=>[t("span",{class:"file-name",title:e.fileName},C(e.fileName),9,te)]),default:o(()=>[t("div",ae,[p(b,{class:"iconfont icon-link",onClick:g=>w(e)},{default:o(()=>[_("复制链接")]),_:2},1032,["onClick"]),p(b,{class:"iconfont icon-cancel",onClick:g=>B(e)},{default:o(()=>[_("取消分享")]),_:2},1032,["onClick"])])]),_:2},1024)):v("",!0)],40,Z)]),expireTime:o(({index:k,row:e})=>[_(C(e.validType==3?"永久":e.expireTime),1)]),_:1},8,["dataSource"])])])])}}},le=q(se,[["__scopeId","data-v-95b28bf8"]]);export{le as default};
