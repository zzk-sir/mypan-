import{_ as be,u as Be,a as Oe,r as R,b as L,o as C,c as K,d as I,F as me,e as se,f as k,w as E,g as ie,h as lt,i as W,t as Y,j as _e,k as rt,n as De,l as Ye,m as Ne,p as oe,q as Ce,s as ve,v as Ve,x as Je,y as ut,z as Ue,A as Re,B as ct}from"./index-Cp_zlRUQ.js";import{m as Ee}from"./md5-DqErH_3x.js";const ht={class:"avatar-upload"},dt={class:"avatar-show"},ft=["src"],pt=["src"],wt={class:"select-btn"},mt={__name:"AvatarUpload",props:{modelValue:{type:Object,default:null}},setup(n,{emit:e}){Be(),Oe(),R("");const s=R(null),t=async a=>{a=a.file;let i=new FileReader;i.readAsDataURL(a),i.onload=({target:d})=>{s.value=d.result},o("update:modelValue",a)},o=e;return(a,i)=>{const d=L("el-button"),u=L("el-upload");return C(),K("div",ht,[I("div",dt,[s.value?(C(),K("img",{key:0,src:s.value},null,8,ft)):(C(),K(me,{key:1},[n.modelValue.userId?(C(),K("img",{key:0,src:`/api/getAvatar/${n.modelValue.userId}`},null,8,pt)):se("",!0)],64))]),I("div",wt,[k(u,{name:"file","show-file-list":!1,accept:".png,.PNG,.jpg,.JPG,.jpeg,.JPEG,.gif,.GIF,.bmp,.BMP",multiple:!1,"http-request":t},{default:E(()=>[k(d,{type:"primary"},{default:E(()=>[ie("选择")]),_:1})]),_:1})])])}}},vt=be(mt,[["__scopeId","data-v-367a1150"]]),gt={__name:"UpdateAvatar",emits:[],setup(n,{expose:e,emit:s}){const{proxy:t}=_e(),o={updateUserAvatar:"/updateUserAvatar"},a=R({}),i=R(),d={title:[{require:!0,message:"请输入内容"}]},u=lt({show:!1,title:"修改头像",buttons:[{type:"danger",text:"确定",click:c=>{r()}}]}),h=s;e({show:c=>{a.value=Object.assign({},c),a.value.avatar={userId:c.id},u.show=!0}});const r=async()=>{if(!(a.value.avatar instanceof File)){u.show=!1;return}await t.Request({url:o.updateUserAvatar,params:{avatar:a.value.avatar}})&&(u.show=!1,h("updateAvatar"))};return(c,f)=>{const m=L("el-form-item"),g=L("el-form"),y=L("Dialog");return C(),W(y,{show:u.show,title:u.title,buttons:u.buttons,width:"400px",showCancel:!1,onClose:f[2]||(f[2]=b=>u.show=!1)},{default:E(()=>[k(g,{model:a.value,rules:d,ref:i.value,"label-width":"80px",onSubmit:f[1]||(f[1]=()=>{})},{default:E(()=>[k(m,{label:"昵称"},{default:E(()=>[ie(Y(a.value.nickName),1)]),_:1}),k(m,{label:"头像上传",prop:""},{default:E(()=>[k(vt,{modelValue:a.value.avatar,"onUpdate:modelValue":f[0]||(f[0]=b=>a.value.avatar=b)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])}}},_t=I("span",{class:"iconfont icon-password"},null,-1),It=I("span",{class:"iconfont icon-password"},null,-1),yt={__name:"UpdatePassword",setup(n,{expose:e}){const{proxy:s}=_e(),t=(r,c,f)=>{c!==i.value.password?f(new Error(r.message)):f()},o={updatePassword:"/updatePassword"},a=R(),i=R({}),d=R({show:!1,title:"修改密码",buttons:[{type:"primary",text:"确定",click:()=>{p()}}]}),u={password:[{required:!0,message:"请输入密码"},{validator:s.Verify.password,message:"请输入数字,字母,-,_,且长度在8-32之间的密码"}],rePassword:[{required:!0,message:"请再次输入密码"},{validator:t,message:"两次密码不一致"}]};e({show:()=>{d.value.show=!0,De(()=>{a.value.resetFields(),i.value={}})}});const p=()=>{a.value.validate(async r=>{if(!r||!await s.Request({url:o.updatePassword,params:{password:Ee(i.value.password)}}))return;d.value.show=!1;let f=s.LocalStorage.get("loginInfo");f.password=Ee(i.value.password),s.LocalStorage.update("loginInfo",f),s.Message.success("密码修改成功")})};return(r,c)=>{const f=L("el-input"),m=L("el-form-item"),g=L("el-form"),y=L("Dialog");return C(),W(y,{show:d.value.show,title:d.value.title,buttons:d.value.buttons,width:"400px",showCancel:!1,onClose:c[3]||(c[3]=b=>d.value.show=!1)},{default:E(()=>[k(g,{model:i.value,rules:u,ref_key:"formDataRef",ref:a,"label-width":"80px",onSubmit:c[2]||(c[2]=rt(()=>{},["prevent"]))},{default:E(()=>[k(m,{label:"新密码",prop:"password"},{default:E(()=>[k(f,{clearable:"",placeholder:"请输入密码",modelValue:i.value.password,"onUpdate:modelValue":c[0]||(c[0]=b=>i.value.password=b),modelModifiers:{trim:!0},size:"large","show-password":""},{prefix:E(()=>[_t]),_:1},8,["modelValue"])]),_:1}),k(m,{label:"确认密码",prop:"rePassword"},{default:E(()=>[k(f,{clearable:"",placeholder:"请再次输入密码",modelValue:i.value.rePassword,"onUpdate:modelValue":c[1]||(c[1]=b=>i.value.rePassword=b),modelModifiers:{trim:!0},size:"large","show-password":""},{prefix:E(()=>[It]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])}}},Xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qe="ARRAYBUFFER not supported by this environment",je="UINT8ARRAY not supported by this environment";function Fe(n,e,s,t){let o,a,i;const d=e||[0],u=(s=s||0)>>>3,h=t===-1?3:0;for(o=0;o<n.length;o+=1)i=o+u,a=i>>>2,d.length<=a&&d.push(0),d[a]|=n[o]<<8*(h+t*(i%4));return{value:d,binLen:8*n.length+s}}function le(n,e,s){switch(e){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(n){case"HEX":return function(t,o,a){return function(i,d,u,h){let p,r,c,f;if(i.length%2!=0)throw new Error("String of HEX type must be in byte increments");const m=d||[0],g=(u=u||0)>>>3,y=h===-1?3:0;for(p=0;p<i.length;p+=2){if(r=parseInt(i.substr(p,2),16),isNaN(r))throw new Error("String of HEX type contains invalid characters");for(f=(p>>>1)+g,c=f>>>2;m.length<=c;)m.push(0);m[c]|=r<<8*(y+h*(f%4))}return{value:m,binLen:4*i.length+u}}(t,o,a,s)};case"TEXT":return function(t,o,a){return function(i,d,u,h,p){let r,c,f,m,g,y,b,U,v=0;const N=u||[0],_=(h=h||0)>>>3;if(d==="UTF8")for(b=p===-1?3:0,f=0;f<i.length;f+=1)for(r=i.charCodeAt(f),c=[],128>r?c.push(r):2048>r?(c.push(192|r>>>6),c.push(128|63&r)):55296>r||57344<=r?c.push(224|r>>>12,128|r>>>6&63,128|63&r):(f+=1,r=65536+((1023&r)<<10|1023&i.charCodeAt(f)),c.push(240|r>>>18,128|r>>>12&63,128|r>>>6&63,128|63&r)),m=0;m<c.length;m+=1){for(y=v+_,g=y>>>2;N.length<=g;)N.push(0);N[g]|=c[m]<<8*(b+p*(y%4)),v+=1}else for(b=p===-1?2:0,U=d==="UTF16LE"&&p!==1||d!=="UTF16LE"&&p===1,f=0;f<i.length;f+=1){for(r=i.charCodeAt(f),U===!0&&(m=255&r,r=m<<8|r>>>8),y=v+_,g=y>>>2;N.length<=g;)N.push(0);N[g]|=r<<8*(b+p*(y%4)),v+=2}return{value:N,binLen:8*v+h}}(t,e,o,a,s)};case"B64":return function(t,o,a){return function(i,d,u,h){let p,r,c,f,m,g,y,b=0;const U=d||[0],v=(u=u||0)>>>3,N=h===-1?3:0,_=i.indexOf("=");if(i.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(i=i.replace(/=/g,""),_!==-1&&_<i.length)throw new Error("Invalid '=' found in base-64 string");for(r=0;r<i.length;r+=4){for(m=i.substr(r,4),f=0,c=0;c<m.length;c+=1)p=Xe.indexOf(m.charAt(c)),f|=p<<18-6*c;for(c=0;c<m.length-1;c+=1){for(y=b+v,g=y>>>2;U.length<=g;)U.push(0);U[g]|=(f>>>16-8*c&255)<<8*(N+h*(y%4)),b+=1}}return{value:U,binLen:8*b+u}}(t,o,a,s)};case"BYTES":return function(t,o,a){return function(i,d,u,h){let p,r,c,f;const m=d||[0],g=(u=u||0)>>>3,y=h===-1?3:0;for(r=0;r<i.length;r+=1)p=i.charCodeAt(r),f=r+g,c=f>>>2,m.length<=c&&m.push(0),m[c]|=p<<8*(y+h*(f%4));return{value:m,binLen:8*i.length+u}}(t,o,a,s)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(qe)}return function(t,o,a){return function(i,d,u,h){return Fe(new Uint8Array(i),d,u,h)}(t,o,a,s)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(je)}return function(t,o,a){return Fe(t,o,a,s)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function He(n,e,s,t){switch(n){case"HEX":return function(o){return function(a,i,d,u){const h="0123456789abcdef";let p,r,c="";const f=i/8,m=d===-1?3:0;for(p=0;p<f;p+=1)r=a[p>>>2]>>>8*(m+d*(p%4)),c+=h.charAt(r>>>4&15)+h.charAt(15&r);return u.outputUpper?c.toUpperCase():c}(o,e,s,t)};case"B64":return function(o){return function(a,i,d,u){let h,p,r,c,f,m="";const g=i/8,y=d===-1?3:0;for(h=0;h<g;h+=3)for(c=h+1<g?a[h+1>>>2]:0,f=h+2<g?a[h+2>>>2]:0,r=(a[h>>>2]>>>8*(y+d*(h%4))&255)<<16|(c>>>8*(y+d*((h+1)%4))&255)<<8|f>>>8*(y+d*((h+2)%4))&255,p=0;p<4;p+=1)m+=8*h+6*p<=i?Xe.charAt(r>>>6*(3-p)&63):u.b64Pad;return m}(o,e,s,t)};case"BYTES":return function(o){return function(a,i,d){let u,h,p="";const r=i/8,c=d===-1?3:0;for(u=0;u<r;u+=1)h=a[u>>>2]>>>8*(c+d*(u%4))&255,p+=String.fromCharCode(h);return p}(o,e,s)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(qe)}return function(o){return function(a,i,d){let u;const h=i/8,p=new ArrayBuffer(h),r=new Uint8Array(p),c=d===-1?3:0;for(u=0;u<h;u+=1)r[u]=a[u>>>2]>>>8*(c+d*(u%4))&255;return p}(o,e,s)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(je)}return function(o){return function(a,i,d){let u;const h=i/8,p=d===-1?3:0,r=new Uint8Array(h);for(u=0;u<h;u+=1)r[u]=a[u>>>2]>>>8*(p+d*(u%4))&255;return r}(o,e,s)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const he=4294967296,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Z=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],Q=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],de="Chosen SHA variant is not supported",Ge="Cannot set numRounds with MAC";function ge(n,e){let s,t;const o=n.binLen>>>3,a=e.binLen>>>3,i=o<<3,d=4-o<<3;if(o%4!=0){for(s=0;s<a;s+=4)t=o+s>>>2,n.value[t]|=e.value[s>>>2]<<i,n.value.push(0),n.value[t+1]|=e.value[s>>>2]>>>d;return(n.value.length<<2)-4>=a+o&&n.value.pop(),{value:n.value,binLen:n.binLen+e.binLen}}return{value:n.value.concat(e.value),binLen:n.binLen+e.binLen}}function Le(n){const e={outputUpper:!1,b64Pad:"=",outputLen:-1},s=n||{},t="Output length must be a multiple of 8";if(e.outputUpper=s.outputUpper||!1,s.b64Pad&&(e.b64Pad=s.b64Pad),s.outputLen){if(s.outputLen%8!=0)throw new Error(t);e.outputLen=s.outputLen}else if(s.shakeLen){if(s.shakeLen%8!=0)throw new Error(t);e.outputLen=s.shakeLen}if(typeof e.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof e.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return e}function ne(n,e,s,t){const o=n+" must include a value and format";if(!e){if(!t)throw new Error(o);return t}if(e.value===void 0||!e.format)throw new Error(o);return le(e.format,e.encoding||"UTF8",s)(e.value)}class Ie{constructor(e,s,t){const o=t||{};if(this.t=s,this.i=o.encoding||"UTF8",this.numRounds=o.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=e,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(e){let s,t=0;const o=this.m>>>5,a=this.C(e,this.h,this.u),i=a.binLen,d=a.value,u=i>>>5;for(s=0;s<u;s+=o)t+this.m<=i&&(this.U=this.v(d.slice(s,s+o),this.U),t+=this.m);return this.A+=t,this.h=d.slice(t>>>5),this.u=i%this.m,this.l=!0,this}getHash(e,s){let t,o,a=this.R;const i=Le(s);if(this.K){if(i.outputLen===-1)throw new Error("Output length must be specified in options");a=i.outputLen}const d=He(e,a,this.T,i);if(this.H&&this.g)return d(this.g(i));for(o=this.F(this.h.slice(),this.u,this.A,this.L(this.U),a),t=1;t<this.numRounds;t+=1)this.K&&a%32!=0&&(o[o.length-1]&=16777215>>>24-a%32),o=this.F(o,a,0,this.B(this.o),a);return d(o)}setHMACKey(e,s,t){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const o=le(s,(t||{}).encoding||"UTF8",this.T);this.k(o(e))}k(e){const s=this.m>>>3,t=s/4-1;let o;if(this.numRounds!==1)throw new Error(Ge);if(this.H)throw new Error("MAC key already set");for(s<e.binLen/8&&(e.value=this.F(e.value,e.binLen,0,this.B(this.o),this.R));e.value.length<=t;)e.value.push(0);for(o=0;o<=t;o+=1)this.S[o]=909522486^e.value[o],this.p[o]=1549556828^e.value[o];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(e,s){const t=Le(s);return He(e,this.R,this.T,t)(this.Y())}Y(){let e;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");const s=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return e=this.v(this.p,this.B(this.o)),e=this.F(s,this.R,this.m,e,this.R),e}}function ae(n,e){return n<<e|n>>>32-e}function V(n,e){return n>>>e|n<<32-e}function Ze(n,e){return n>>>e}function Te(n,e,s){return n^e^s}function Qe(n,e,s){return n&e^~n&s}function We(n,e,s){return n&e^n&s^e&s}function At(n){return V(n,2)^V(n,13)^V(n,22)}function P(n,e){const s=(65535&n)+(65535&e);return(65535&(n>>>16)+(e>>>16)+(s>>>16))<<16|65535&s}function Nt(n,e,s,t){const o=(65535&n)+(65535&e)+(65535&s)+(65535&t);return(65535&(n>>>16)+(e>>>16)+(s>>>16)+(t>>>16)+(o>>>16))<<16|65535&o}function ce(n,e,s,t,o){const a=(65535&n)+(65535&e)+(65535&s)+(65535&t)+(65535&o);return(65535&(n>>>16)+(e>>>16)+(s>>>16)+(t>>>16)+(o>>>16)+(a>>>16))<<16|65535&a}function St(n){return V(n,7)^V(n,18)^Ze(n,3)}function bt(n){return V(n,6)^V(n,11)^V(n,25)}function kt(n){return[1732584193,4023233417,2562383102,271733878,3285377520]}function et(n,e){let s,t,o,a,i,d,u;const h=[];for(s=e[0],t=e[1],o=e[2],a=e[3],i=e[4],u=0;u<80;u+=1)h[u]=u<16?n[u]:ae(h[u-3]^h[u-8]^h[u-14]^h[u-16],1),d=u<20?ce(ae(s,5),Qe(t,o,a),i,1518500249,h[u]):u<40?ce(ae(s,5),Te(t,o,a),i,1859775393,h[u]):u<60?ce(ae(s,5),We(t,o,a),i,2400959708,h[u]):ce(ae(s,5),Te(t,o,a),i,3395469782,h[u]),i=a,a=o,o=ae(t,30),t=s,s=d;return e[0]=P(s,e[0]),e[1]=P(t,e[1]),e[2]=P(o,e[2]),e[3]=P(a,e[3]),e[4]=P(i,e[4]),e}function Ct(n,e,s,t){let o;const a=15+(e+65>>>9<<4),i=e+s;for(;n.length<=a;)n.push(0);for(n[e>>>5]|=128<<24-e%32,n[a]=4294967295&i,n[a-1]=i/he|0,o=0;o<n.length;o+=16)t=et(n.slice(o,o+16),t);return t}let Ut=class extends Ie{constructor(n,e,s){if(n!=="SHA-1")throw new Error(de);super(n,e,s);const t=s||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=le(this.t,this.i,this.T),this.v=et,this.L=function(o){return o.slice()},this.B=kt,this.F=Ct,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,t.hmacKey&&this.k(ne("hmacKey",t.hmacKey,this.T))}};function Me(n){let e;return e=n=="SHA-224"?Z.slice():Q.slice(),e}function Pe(n,e){let s,t,o,a,i,d,u,h,p,r,c;const f=[];for(s=e[0],t=e[1],o=e[2],a=e[3],i=e[4],d=e[5],u=e[6],h=e[7],c=0;c<64;c+=1)f[c]=c<16?n[c]:Nt(V(m=f[c-2],17)^V(m,19)^Ze(m,10),f[c-7],St(f[c-15]),f[c-16]),p=ce(h,bt(i),Qe(i,d,u),w[c],f[c]),r=P(At(s),We(s,t,o)),h=u,u=d,d=i,i=P(a,p),a=o,o=t,t=s,s=P(p,r);var m;return e[0]=P(s,e[0]),e[1]=P(t,e[1]),e[2]=P(o,e[2]),e[3]=P(a,e[3]),e[4]=P(i,e[4]),e[5]=P(d,e[5]),e[6]=P(u,e[6]),e[7]=P(h,e[7]),e}let Rt=class extends Ie{constructor(n,e,s){if(n!=="SHA-224"&&n!=="SHA-256")throw new Error(de);super(n,e,s);const t=s||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=le(this.t,this.i,this.T),this.v=Pe,this.L=function(o){return o.slice()},this.B=Me,this.F=function(o,a,i,d){return function(u,h,p,r,c){let f,m;const g=15+(h+65>>>9<<4),y=h+p;for(;u.length<=g;)u.push(0);for(u[h>>>5]|=128<<24-h%32,u[g]=4294967295&y,u[g-1]=y/he|0,f=0;f<u.length;f+=16)r=Pe(u.slice(f,f+16),r);return m=c==="SHA-224"?[r[0],r[1],r[2],r[3],r[4],r[5],r[6]]:r,m}(o,a,i,d,n)},this.U=Me(n),this.m=512,this.R=n==="SHA-224"?224:256,this.K=!1,t.hmacKey&&this.k(ne("hmacKey",t.hmacKey,this.T))}};class l{constructor(e,s){this.N=e,this.I=s}}function Ke(n,e){let s;return e>32?(s=64-e,new l(n.I<<e|n.N>>>s,n.N<<e|n.I>>>s)):e!==0?(s=32-e,new l(n.N<<e|n.I>>>s,n.I<<e|n.N>>>s)):n}function J(n,e){let s;return e<32?(s=32-e,new l(n.N>>>e|n.I<<s,n.I>>>e|n.N<<s)):(s=64-e,new l(n.I>>>e|n.N<<s,n.N>>>e|n.I<<s))}function tt(n,e){return new l(n.N>>>e,n.I>>>e|n.N<<32-e)}function Et(n,e,s){return new l(n.N&e.N^n.N&s.N^e.N&s.N,n.I&e.I^n.I&s.I^e.I&s.I)}function Ft(n){const e=J(n,28),s=J(n,34),t=J(n,39);return new l(e.N^s.N^t.N,e.I^s.I^t.I)}function D(n,e){let s,t;s=(65535&n.I)+(65535&e.I),t=(n.I>>>16)+(e.I>>>16)+(s>>>16);const o=(65535&t)<<16|65535&s;return s=(65535&n.N)+(65535&e.N)+(t>>>16),t=(n.N>>>16)+(e.N>>>16)+(s>>>16),new l((65535&t)<<16|65535&s,o)}function Ht(n,e,s,t){let o,a;o=(65535&n.I)+(65535&e.I)+(65535&s.I)+(65535&t.I),a=(n.I>>>16)+(e.I>>>16)+(s.I>>>16)+(t.I>>>16)+(o>>>16);const i=(65535&a)<<16|65535&o;return o=(65535&n.N)+(65535&e.N)+(65535&s.N)+(65535&t.N)+(a>>>16),a=(n.N>>>16)+(e.N>>>16)+(s.N>>>16)+(t.N>>>16)+(o>>>16),new l((65535&a)<<16|65535&o,i)}function Lt(n,e,s,t,o){let a,i;a=(65535&n.I)+(65535&e.I)+(65535&s.I)+(65535&t.I)+(65535&o.I),i=(n.I>>>16)+(e.I>>>16)+(s.I>>>16)+(t.I>>>16)+(o.I>>>16)+(a>>>16);const d=(65535&i)<<16|65535&a;return a=(65535&n.N)+(65535&e.N)+(65535&s.N)+(65535&t.N)+(65535&o.N)+(i>>>16),i=(n.N>>>16)+(e.N>>>16)+(s.N>>>16)+(t.N>>>16)+(o.N>>>16)+(a>>>16),new l((65535&i)<<16|65535&a,d)}function ue(n,e){return new l(n.N^e.N,n.I^e.I)}function Tt(n){const e=J(n,19),s=J(n,61),t=tt(n,6);return new l(e.N^s.N^t.N,e.I^s.I^t.I)}function Mt(n){const e=J(n,1),s=J(n,8),t=tt(n,7);return new l(e.N^s.N^t.N,e.I^s.I^t.I)}function Pt(n){const e=J(n,14),s=J(n,18),t=J(n,41);return new l(e.N^s.N^t.N,e.I^s.I^t.I)}const Kt=[new l(w[0],3609767458),new l(w[1],602891725),new l(w[2],3964484399),new l(w[3],2173295548),new l(w[4],4081628472),new l(w[5],3053834265),new l(w[6],2937671579),new l(w[7],3664609560),new l(w[8],2734883394),new l(w[9],1164996542),new l(w[10],1323610764),new l(w[11],3590304994),new l(w[12],4068182383),new l(w[13],991336113),new l(w[14],633803317),new l(w[15],3479774868),new l(w[16],2666613458),new l(w[17],944711139),new l(w[18],2341262773),new l(w[19],2007800933),new l(w[20],1495990901),new l(w[21],1856431235),new l(w[22],3175218132),new l(w[23],2198950837),new l(w[24],3999719339),new l(w[25],766784016),new l(w[26],2566594879),new l(w[27],3203337956),new l(w[28],1034457026),new l(w[29],2466948901),new l(w[30],3758326383),new l(w[31],168717936),new l(w[32],1188179964),new l(w[33],1546045734),new l(w[34],1522805485),new l(w[35],2643833823),new l(w[36],2343527390),new l(w[37],1014477480),new l(w[38],1206759142),new l(w[39],344077627),new l(w[40],1290863460),new l(w[41],3158454273),new l(w[42],3505952657),new l(w[43],106217008),new l(w[44],3606008344),new l(w[45],1432725776),new l(w[46],1467031594),new l(w[47],851169720),new l(w[48],3100823752),new l(w[49],1363258195),new l(w[50],3750685593),new l(w[51],3785050280),new l(w[52],3318307427),new l(w[53],3812723403),new l(w[54],2003034995),new l(w[55],3602036899),new l(w[56],1575990012),new l(w[57],1125592928),new l(w[58],2716904306),new l(w[59],442776044),new l(w[60],593698344),new l(w[61],3733110249),new l(w[62],2999351573),new l(w[63],3815920427),new l(3391569614,3928383900),new l(3515267271,566280711),new l(3940187606,3454069534),new l(4118630271,4000239992),new l(116418474,1914138554),new l(174292421,2731055270),new l(289380356,3203993006),new l(460393269,320620315),new l(685471733,587496836),new l(852142971,1086792851),new l(1017036298,365543100),new l(1126000580,2618297676),new l(1288033470,3409855158),new l(1501505948,4234509866),new l(1607167915,987167468),new l(1816402316,1246189591)];function xe(n){return n==="SHA-384"?[new l(3418070365,Z[0]),new l(1654270250,Z[1]),new l(2438529370,Z[2]),new l(355462360,Z[3]),new l(1731405415,Z[4]),new l(41048885895,Z[5]),new l(3675008525,Z[6]),new l(1203062813,Z[7])]:[new l(Q[0],4089235720),new l(Q[1],2227873595),new l(Q[2],4271175723),new l(Q[3],1595750129),new l(Q[4],2917565137),new l(Q[5],725511199),new l(Q[6],4215389547),new l(Q[7],327033209)]}function $e(n,e){let s,t,o,a,i,d,u,h,p,r,c,f;const m=[];for(s=e[0],t=e[1],o=e[2],a=e[3],i=e[4],d=e[5],u=e[6],h=e[7],c=0;c<80;c+=1)c<16?(f=2*c,m[c]=new l(n[f],n[f+1])):m[c]=Ht(Tt(m[c-2]),m[c-7],Mt(m[c-15]),m[c-16]),p=Lt(h,Pt(i),(y=d,b=u,new l((g=i).N&y.N^~g.N&b.N,g.I&y.I^~g.I&b.I)),Kt[c],m[c]),r=D(Ft(s),Et(s,t,o)),h=u,u=d,d=i,i=D(a,p),a=o,o=t,t=s,s=D(p,r);var g,y,b;return e[0]=D(s,e[0]),e[1]=D(t,e[1]),e[2]=D(o,e[2]),e[3]=D(a,e[3]),e[4]=D(i,e[4]),e[5]=D(d,e[5]),e[6]=D(u,e[6]),e[7]=D(h,e[7]),e}let xt=class extends Ie{constructor(n,e,s){if(n!=="SHA-384"&&n!=="SHA-512")throw new Error(de);super(n,e,s);const t=s||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=le(this.t,this.i,this.T),this.v=$e,this.L=function(o){return o.slice()},this.B=xe,this.F=function(o,a,i,d){return function(u,h,p,r,c){let f,m;const g=31+(h+129>>>10<<5),y=h+p;for(;u.length<=g;)u.push(0);for(u[h>>>5]|=128<<24-h%32,u[g]=4294967295&y,u[g-1]=y/he|0,f=0;f<u.length;f+=32)r=$e(u.slice(f,f+32),r);return m=c==="SHA-384"?[r[0].N,r[0].I,r[1].N,r[1].I,r[2].N,r[2].I,r[3].N,r[3].I,r[4].N,r[4].I,r[5].N,r[5].I]:[r[0].N,r[0].I,r[1].N,r[1].I,r[2].N,r[2].I,r[3].N,r[3].I,r[4].N,r[4].I,r[5].N,r[5].I,r[6].N,r[6].I,r[7].N,r[7].I],m}(o,a,i,d,n)},this.U=xe(n),this.m=1024,this.R=n==="SHA-384"?384:512,this.K=!1,t.hmacKey&&this.k(ne("hmacKey",t.hmacKey,this.T))}};const $t=[new l(0,1),new l(0,32898),new l(2147483648,32906),new l(2147483648,2147516416),new l(0,32907),new l(0,2147483649),new l(2147483648,2147516545),new l(2147483648,32777),new l(0,138),new l(0,136),new l(0,2147516425),new l(0,2147483658),new l(0,2147516555),new l(2147483648,139),new l(2147483648,32905),new l(2147483648,32771),new l(2147483648,32770),new l(2147483648,128),new l(0,32778),new l(2147483648,2147483658),new l(2147483648,2147516545),new l(2147483648,32896),new l(0,2147483649),new l(2147483648,2147516424)],zt=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function Se(n){let e;const s=[];for(e=0;e<5;e+=1)s[e]=[new l(0,0),new l(0,0),new l(0,0),new l(0,0),new l(0,0)];return s}function Bt(n){let e;const s=[];for(e=0;e<5;e+=1)s[e]=n[e].slice();return s}function we(n,e){let s,t,o,a;const i=[],d=[];if(n!==null)for(t=0;t<n.length;t+=2)e[(t>>>1)%5][(t>>>1)/5|0]=ue(e[(t>>>1)%5][(t>>>1)/5|0],new l(n[t+1],n[t]));for(s=0;s<24;s+=1){for(a=Se(),t=0;t<5;t+=1)i[t]=(u=e[t][0],h=e[t][1],p=e[t][2],r=e[t][3],c=e[t][4],new l(u.N^h.N^p.N^r.N^c.N,u.I^h.I^p.I^r.I^c.I));for(t=0;t<5;t+=1)d[t]=ue(i[(t+4)%5],Ke(i[(t+1)%5],1));for(t=0;t<5;t+=1)for(o=0;o<5;o+=1)e[t][o]=ue(e[t][o],d[t]);for(t=0;t<5;t+=1)for(o=0;o<5;o+=1)a[o][(2*t+3*o)%5]=Ke(e[t][o],zt[t][o]);for(t=0;t<5;t+=1)for(o=0;o<5;o+=1)e[t][o]=ue(a[t][o],new l(~a[(t+1)%5][o].N&a[(t+2)%5][o].N,~a[(t+1)%5][o].I&a[(t+2)%5][o].I));e[0][0]=ue(e[0][0],$t[s])}var u,h,p,r,c;return e}function st(n){let e,s,t=0;const o=[0,0],a=[4294967295&n,n/he&2097151];for(e=6;e>=0;e--)s=a[e>>2]>>>8*e&255,s===0&&t===0||(o[t+1>>2]|=s<<8*(t+1),t+=1);return t=t!==0?t:1,o[0]|=t,{value:t+1>4?o:[o[0]],binLen:8+8*t}}function Ae(n){return ge(st(n.binLen),n)}function ze(n,e){let s,t=st(e);t=ge(t,n);const o=e>>>2,a=(o-t.value.length%o)%o;for(s=0;s<a;s++)t.value.push(0);return t.value}let Ot=class extends Ie{constructor(n,e,s){let t=6,o=0;super(n,e,s);const a=s||{};if(this.numRounds!==1){if(a.kmacKey||a.hmacKey)throw new Error(Ge);if(this.o==="CSHAKE128"||this.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=le(this.t,this.i,this.T),this.v=we,this.L=Bt,this.B=Se,this.U=Se(),this.K=!1,n){case"SHA3-224":this.m=o=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=o=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=o=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=o=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":t=31,this.m=o=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":t=31,this.m=o=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":t=4,this.m=o=1344,this.X(s),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":t=4,this.m=o=1088,this.X(s),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=o=1344,t=this.O(s),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=o=1088,t=this.O(s),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(de)}this.F=function(i,d,u,h,p){return function(r,c,f,m,g,y,b){let U,v,N=0;const _=[],F=g>>>5,H=c>>>5;for(U=0;U<H&&c>=g;U+=F)m=we(r.slice(U,U+F),m),c-=g;for(r=r.slice(U),c%=g;r.length<F;)r.push(0);for(U=c>>>3,r[U>>2]^=y<<U%4*8,r[F-1]^=2147483648,m=we(r,m);32*_.length<b&&(v=m[N%5][N/5|0],_.push(v.I),!(32*_.length>=b));)_.push(v.N),N+=1,64*N%g==0&&(we(null,m),N=0);return _}(i,d,0,h,o,t,p)},a.hmacKey&&this.k(ne("hmacKey",a.hmacKey,this.T))}O(n,e){const s=function(o){const a=o||{};return{funcName:ne("funcName",a.funcName,1,{value:[],binLen:0}),customization:ne("Customization",a.customization,1,{value:[],binLen:0})}}(n||{});e&&(s.funcName=e);const t=ge(Ae(s.funcName),Ae(s.customization));if(s.customization.binLen!==0||s.funcName.binLen!==0){const o=ze(t,this.m>>>3);for(let a=0;a<o.length;a+=this.m>>>5)this.U=this.v(o.slice(a,a+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(n){const e=function(t){const o=t||{};return{kmacKey:ne("kmacKey",o.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:ne("Customization",o.customization,1,{value:[],binLen:0})}}(n||{});this.O(n,e.funcName);const s=ze(Ae(e.kmacKey),this.m>>>3);for(let t=0;t<s.length;t+=this.m>>>5)this.U=this.v(s.slice(t,t+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(n){const e=ge({value:this.h.slice(),binLen:this.u},function(s){let t,o,a=0;const i=[0,0],d=[4294967295&s,s/he&2097151];for(t=6;t>=0;t--)o=d[t>>2]>>>8*t&255,o===0&&a===0||(i[a>>2]|=o<<8*a,a+=1);return a=a!==0?a:1,i[a>>2]|=a<<8*a,{value:a+1>4?i:[i[0]],binLen:8+8*a}}(n.outputLen));return this.F(e.value,e.binLen,this.A,this.L(this.U),n.outputLen)}};class Dt{constructor(e,s,t){if(e=="SHA-1")this.P=new Ut(e,s,t);else if(e=="SHA-224"||e=="SHA-256")this.P=new Rt(e,s,t);else if(e=="SHA-384"||e=="SHA-512")this.P=new xt(e,s,t);else{if(e!="SHA3-224"&&e!="SHA3-256"&&e!="SHA3-384"&&e!="SHA3-512"&&e!="SHAKE128"&&e!="SHAKE256"&&e!="CSHAKE128"&&e!="CSHAKE256"&&e!="KMAC128"&&e!="KMAC256")throw new Error(de);this.P=new Ot(e,s,t)}}update(e){return this.P.update(e),this}getHash(e,s){return this.P.getHash(e,s)}setHMACKey(e,s,t){this.P.setHMACKey(e,s,t)}getHMAC(e,s){return this.P.getHMAC(e,s)}}const ke=n=>(Ve("data-v-d71bf299"),n=n(),Je(),n),Yt={class:"uploader-panel"},Vt={class:"uploader-title"},Jt=ke(()=>I("span",null,"上传任务",-1)),Xt=ke(()=>I("span",{class:"tips"},"（仅展示本次上传任务）",-1)),qt=ke(()=>I("span",{class:"iconfont icon-del m-right"},null,-1)),jt={class:"file-list"},Gt={class:"upload-panel"},Zt={class:"file-name"},Qt={class:"progress"},Wt={class:"upload-status"},es={key:0,class:"upload-info"},ts={class:"op"},ss={class:"op-btn"},ns={key:0},os={key:0},G=1024*1024*5,as={__name:"Uploader",emits:["uploadCallback"],setup(n,{expose:e,emit:s}){const{proxy:t}=_e(),o={upload:"/file/uploadFile"},a=R([]),i={emptyfile:{value:"emptyfile",desc:"文件为空",color:"#F75000",icon:"close"},fail:{value:"fail",desc:"上传失败",color:"#F75000",icon:"close"},init:{value:"init",desc:"解析中",color:"#e6a23c",icon:"clock"},uploading:{value:"uploading",desc:"上传中",color:"#409eff",icon:"upload"},upload_finish:{value:"upload_finish",desc:"上传完成",color:"#67c23a",icon:"ok"},upload_seconds:{value:"upload_seconds",desc:"秒传",color:"#67c23a",icon:"ok"}},d=R([]),u=async v=>{let N=v.file,_=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,F=Math.ceil(N.size/G),H=0,X=new Dt("SHA3-256","TEXT"),A=new FileReader,$=()=>{let T=H*G,ee=T+G>=N.size?N.size:T+G;A.readAsArrayBuffer(_.call(N,T,ee))};return $(),new Promise((T,ee)=>{let z=h(N.uid);z.md5Progress=0,A.onload=B=>{if(X.update(new Int8Array(B.target.result).join("")),H++,H<F){let q=Math.floor(H/F*100);z.md5Progress=q,$()}else{let q=X.getHash("HEX");z.md5Progress=100,z.status=i.uploading.value,z.md5=q,T(v.uid)}},A.onerror=B=>{z.md5Progress=-1,z.status=i.fail.value,T(v.uid)}}).catch(T=>(console.error(T),null))},h=v=>a.value.find(_=>_.file.uid===v),p=(v,N)=>{for(let _=0;_<a.value.length;_++)if(a.value[_].file.uid===v){Object.assign(a.value[_],N);break}},r=v=>{p(v,{pause:!1}),U(v,h(v).chunkIndex),localStorage.setItem("filelist",JSON.stringify(a.value))},c=v=>{p(v,{pause:!0}),localStorage.setItem("filelist",JSON.stringify(a.value))},f=()=>{a.value=[],localStorage.setItem("filelist",JSON.stringify(a.value))},m=(v,N)=>{a.value.splice(N,1),localStorage.setItem("filelist",JSON.stringify(a.value))},g=(v,N)=>{a.value.splice(N,1),localStorage.setItem("filelist",JSON.stringify(a.value))};Ye(()=>{let v=localStorage.getItem("filelist");v&&(a.value=JSON.parse(v))});const y=s;e({addFile:async(v,N)=>{const _={file:v,uid:v.uid,md5Progress:0,md5:null,fileName:v.name,status:i.init.value,uploadSize:0,totalSize:v.size,uploadProgress:0,pause:!1,chunkIndex:0,filePid:N,errorMsg:null,type:v.type};if(a.value.unshift(_),_.totalSize==0){_.status=i.emptyfile.value,localStorage.setItem("filelist",JSON.stringify(a.value));return}let F=await u(_);F!=null&&U(F)}});const U=async(v,N)=>{N=N||0;let _=h(v),F=_.file;if(!F.name)try{F=await t.IdbFileTool.getFile(v)}catch(A){t.Message.error(A);return}const H=_.totalSize,X=Math.ceil(H/G);for(let A=N;A<X;A++){let $=d.value.indexOf(v);if($!=-1){d.value.slice($,1);break}if(_.pause){p(v,{chunkIndex:A}),t.IdbFileTool.saveFile(F,v),localStorage.setItem("filelist",JSON.stringify(a.value));return}let T=A*G,ee=T+G>=H?H:T+G,z=F.slice(T,ee),B=await t.Request({url:o.upload,showLoading:!1,dataType:"file",params:{file:z,fileName:F.name,fileMd5:_.md5,chunkIndex:A,chunks:X,fileId:_.fileId,filePid:_.filePid},showError:!1,errorCallback:q=>{_.status=i.fail.value,_.errorMsg=q},onUploadProgressCallback:q=>{let j=q.loaded;j>H&&(j=H),_.uploadSize=A*G+j,_.uploadProgress=Math.floor(_.uploadSize/H*100)}});if(B==null)break;if(_.fileId=B.fileId,_.status=i[B.status].value,_.chunkIndex=A,B.status==i.upload_seconds.value||B.status==i.upload_finish.value){t.IdbFileTool.delFile(v),_.uploadProgress=100,y("uploadCallback");break}}localStorage.setItem("filelist",JSON.stringify(a.value))};return(v,N)=>{const _=L("el-button"),F=L("el-progress"),H=L("Icon"),X=L("NoData");return C(),K("div",Yt,[I("div",Vt,[Jt,Xt,k(_,{type:"danger",onClick:f,disabled:a.value.length==0},{default:E(()=>[qt,ie(" 清空 ")]),_:1},8,["disabled"])]),I("div",jt,[(C(!0),K(me,null,Ne(a.value,(A,$)=>(C(),K("div",{key:$,class:"file-item"},[I("div",Gt,[I("div",Zt,Y(A.fileName),1),I("div",Qt,[A.status==i.uploading.value||A.status==i.upload_seconds.value||A.status==i.upload_finish.value?(C(),W(F,{key:0,percentage:A.uploadProgress},null,8,["percentage"])):se("",!0)]),I("div",Wt,[I("span",{class:oe(["iconfont","icon-"+i[A.status].icon]),style:Ce({color:i[A.status].color})},null,6),I("span",{class:"stauts",style:Ce({color:i[A.status].color})},Y(A.status=="fail"?A.errorMsg:i[A.status].desc),5),A.status==i.uploading.value?(C(),K("span",es,Y(ve(t).Utils.size2Str(A.uploadSize))+" / "+Y(ve(t).Utils.size2Str(A.totalSize)),1)):se("",!0)])]),I("div",ts,[A.status==i.init.value?(C(),W(F,{key:0,type:"circle",width:50,percentage:A.md5Progress},null,8,["percentage"])):se("",!0),I("div",ss,[A.status==i.uploading.value?(C(),K("span",ns,[A.pause?(C(),W(H,{key:0,width:28,class:"btn-item",iconName:"upload",title:"上传",onClick:T=>r(A.uid)},null,8,["onClick"])):(C(),W(H,{key:1,width:28,class:"btn-item",iconName:"pause",title:"暂停",onClick:T=>c(A.uid)},null,8,["onClick"]))])):se("",!0),A.status!=i.init.value&&A.status!=i.upload_finish.value&&A.status!=i.upload_seconds.value?(C(),W(H,{key:1,width:28,class:"btn-item",iconName:"del",title:"删除",onClick:T=>m(A.uid,$)},null,8,["onClick"])):se("",!0),A.status==i.upload_finish.value||A.status==i.upload_seconds.value?(C(),W(H,{key:2,width:28,class:"btn-item",iconName:"clean",title:"清除",onClick:T=>g(A.uid,$)},null,8,["onClick"])):se("",!0)])])]))),128)),a.value.length==0?(C(),K("div",os,[k(X,{msg:"暂无上传任务"})])):se("",!0)])])}}},is=be(as,[["__scopeId","data-v-d71bf299"]]),fe=n=>(Ve("data-v-84cbf204"),n=n(),Je(),n),ls=fe(()=>I("h2",null,"放入当前文件夹",-1)),rs=[ls],us={class:"header"},cs=fe(()=>I("span",{class:"iconfont icon-pan"},null,-1)),hs=fe(()=>I("div",{class:"name"},"My Pan",-1)),ds=[cs,hs],fs={class:"right-panel"},ps=fe(()=>I("span",{class:"iconfont icon-transfer"},null,-1)),ws={class:"user-info"},ms={class:"avatar"},vs={class:"nickname"},gs={class:"body"},_s={class:"left-sider"},Is={class:"menu-list"},ys=["onClick"],As={class:"text"},Ns={class:"menu-sub-list"},Ss=["onClick"],bs={class:"text"},ks={class:"space-info"},Cs=fe(()=>I("div",null,"空间使用",-1)),Us={class:"percent"},Rs={class:"space-use"},Es={class:"use"},Fs={class:"body-content"},Hs={__name:"Layout",setup(n){const e=Be(),s=Oe(),{proxy:t}=_e(),o={getUserInfo:"/getUserInfo",logout:"/logout",getUseSpace:"/getUseSpace"},a=R(0),i=R({}),d=R(!1),u=R([{icon:"cloude",name:"首页",menuCode:"main",path:"/main/all",allShow:!0,children:[{icon:"all",name:"全部",category:"all",path:"/main/all"},{icon:"video",name:"视频",category:"video",path:"/main/video"},{icon:"music",name:"音频",category:"music",path:"/main/music"},{icon:"image",name:"图片",category:"image",path:"/main/image"},{icon:"doc",name:"文档",category:"doc",path:"/main/doc"},{icon:"more",name:"其他",category:"other",path:"/main/others"}]},{path:"/myshare",icon:"share",name:"分享",menuCode:"share",allShow:!0,children:[{name:"分享记录",path:"/myshare"}]},{path:"/recycle",icon:"del",name:"回收站",menuCode:"recycle",tips:"回收站为您保存10天内删除的文件",allShow:!0,children:[{name:"回收站",path:"/recycle"}]}]),h=R({}),p=R(),r=R(!1),c=R(),f=R(),m=R(),g=R(null),y=R(),b=R({useSpace:0,totalSpace:1}),U=S=>{!S.path||S.menuCode==h.value.menuCode||e.push(S.path)},v=()=>{console.log("goHome"),e.push("/")},N=(S,x)=>{const O=u.value.find(te=>te.menuCode==S);h.value=O,p.value=x},_=()=>{let S=JSON.parse(sessionStorage.getItem("user"));S.avatar=null,i.value=S,a.value=new Date().getTime()},F=()=>{f.value.show(i.value)},H=()=>{m.value.show()},X=S=>{const{file:x,filePid:O,addFileCallback:te}=S;r.value=!0,c.value.addFile(x,O),g.value=te},A=()=>{De(()=>{y.value.reload(),j()})},$=()=>{let S=JSON.parse(sessionStorage.getItem("user"));S&&S.isAdmin&&u.value.length==3&&u.value.push({path:"/settings/fileList",icon:"settings",name:"设置",menuCode:"settings",allShow:!0,children:[{name:"用户文件",path:"/settings/fileList"},{name:"用户管理",path:"/settings/userList"},{name:"系统管理",path:"/settings/sysSetting"}]})},T=S=>{S.preventDefault();const x=S.dataTransfer.items;for(const O of x){const te=O.getAsFile(),re=t.Utils.fileUid();te.uid=re;let pe=O.webkitGetAsEntry();y.value.dropFile&&(pe.isFile?y.value.dropFile(te):t.Confirm("你确定要上传文件夹以及其中所有的文件到当前目录吗？",()=>{y.value.dropFolder(pe)}))}d.value=!1};let ee=null;const z=S=>{y.value.dropFile&&(S.preventDefault(),ee&&clearTimeout(ee),ee=setTimeout(()=>{d.value=!1},1e3),d.value=!0)};Ye(async()=>{await B();let S=JSON.parse(sessionStorage.getItem("user"));S.avatar=null,i.value=S,$(),j()});const B=async()=>{sessionStorage.getItem("user");const S=await t.Request({url:o.getUserInfo,params:{}});S&&sessionStorage.setItem("user",JSON.stringify(S))},q=()=>{t.Confirm("您确定要退出吗？",async()=>{await t.Request({url:o.logout})&&(sessionStorage.clear(),t.LocalStorage.remove("loginInfo"),e.push("/login"))})},j=async()=>{let S=await t.Request({url:o.getUseSpace,showLoading:!1});S&&(b.value=S)};return ut(()=>s,async(S,x)=>{await j(),await B();let O=sessionStorage.getItem("user");O!=null&&O&&$(),S.meta.menuCode&&N(S.meta.menuCode,S.path)},{immediate:!0,deep:!0}),(S,x)=>{const O=L("el-popover"),te=L("Avatar"),re=L("el-dropdown-item"),pe=L("el-dropdown-menu"),nt=L("el-dropdown"),ot=L("el-progress"),at=L("router-view");return C(),K("div",{class:"framework",onDrop:x[1]||(x[1]=M=>T(M)),onDragover:x[2]||(x[2]=M=>z(M))},[I("div",{id:"mask",class:oe(["mask",d.value?"show":""])},null,2),I("div",{id:"modal",class:oe(["modal",d.value?"show":""])},rs,2),I("div",us,[I("div",{class:"logo",onClick:v},ds),I("div",fs,[k(O,{width:800,trigger:"click",visible:r.value,"onUpdate:visible":x[0]||(x[0]=M=>r.value=M),offset:20,transition:"none","hide-after":0,"popper-style":{padding:"0px"}},{reference:E(()=>[ps]),default:E(()=>[k(is,{ref_key:"uploaderRef",ref:c,onUploadCallback:A},null,512)]),_:1},8,["visible"]),k(nt,null,{dropdown:E(()=>[k(pe,null,{default:E(()=>[k(re,{onClick:F},{default:E(()=>[ie("修改头像")]),_:1}),k(re,{onClick:H},{default:E(()=>[ie("修改密码")]),_:1}),k(re,{onClick:q},{default:E(()=>[ie("退出登录")]),_:1})]),_:1})]),default:E(()=>[I("div",ws,[I("div",ms,[k(te,{userId:i.value.id,avatar:i.value.avatar,timestamp:a.value,width:46},null,8,["userId","avatar","timestamp"])]),I("span",vs,Y(i.value.nickName),1)])]),_:1})])]),I("div",gs,[I("div",_s,[I("div",Is,[(C(!0),K(me,null,Ne(u.value,(M,ye)=>(C(),K("div",{onClick:it=>U(M),class:oe(["menu-item",M.menuCode==h.value.menuCode?"active":""]),key:ye},[I("div",{class:oe(["iconfont","icon-"+M.icon])},null,2),I("div",As,Y(M.name),1)],10,ys))),128))]),I("div",Ns,[(C(!0),K(me,null,Ne(h.value.children,(M,ye)=>(C(),K("div",{onClick:it=>U(M),class:oe(["menu-item-sub",p.value==M.path?"active":""]),key:ye},[Ue(I("span",{class:oe(["iconfont","icon-"+M.icon])},null,2),[[Re,M.icon]]),I("span",bs,Y(M.name),1)],10,Ss))),128)),Ue(I("div",{class:"tips"},Y(h.value.tips),513),[[Re,h.value&&h.value.tips]]),I("div",ks,[Cs,I("div",Us,[k(ot,{percentage:Math.floor(b.value.useSpace/b.value.totalSpace*1e4)/100,color:"#409eff"},null,8,["percentage"]),I("div",Rs,[I("div",Es,Y(ve(t).Utils.size2Str(b.value.useSpace))+" / "+Y(ve(t).Utils.size2Str(b.value.totalSpace)),1),I("div",{class:"iconfont icon-refresh",onClick:j})])])])])]),I("div",Fs,[k(at,null,{default:E(({Component:M})=>[(C(),W(ct(M),{ref_key:"routerViewRef",ref:y,onAddFile:X,onReload:j},null,544))]),_:1})])]),k(gt,{ref_key:"updateAvatarRef",ref:f,onUpdateAvatar:_},null,512),k(yt,{ref_key:"updatePasswordRef",ref:m},null,512)],32)}}},Ms=be(Hs,[["__scopeId","data-v-84cbf204"]]);export{Ms as default};
