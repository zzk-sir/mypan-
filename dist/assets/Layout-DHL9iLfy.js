import{_ as be,u as Be,a as Oe,r as R,b as T,o as C,c as x,d as _,F as me,e as te,f as k,w as E,g as ie,h as rt,i as Q,t as V,j as _e,k as lt,n as De,l as Ye,m as Ne,p as ne,q as Ce,s as ve,v as Ve,x as Je,y as ut,z as Ue,A as Re,B as ct}from"./index-Wtykptcl.js";import{m as Ee}from"./md5-DLhiPZGR.js";const ht={class:"avatar-upload"},dt={class:"avatar-show"},ft=["src"],pt=["src"],wt={class:"select-btn"},mt={__name:"AvatarUpload",props:{modelValue:{type:Object,default:null}},setup(n,{emit:e}){Be(),Oe(),R("");const s=R(null),t=async a=>{a=a.file;let i=new FileReader;i.readAsDataURL(a),i.onload=({target:h})=>{s.value=h.result},o("update:modelValue",a)},o=e;return(a,i)=>{const h=T("el-button"),u=T("el-upload");return C(),x("div",ht,[_("div",dt,[s.value?(C(),x("img",{key:0,src:s.value},null,8,ft)):(C(),x(me,{key:1},[n.modelValue.userId?(C(),x("img",{key:0,src:`/api/getAvatar/${n.modelValue.userId}`},null,8,pt)):te("",!0)],64))]),_("div",wt,[k(u,{name:"file","show-file-list":!1,accept:".png,.PNG,.jpg,.JPG,.jpeg,.JPEG,.gif,.GIF,.bmp,.BMP",multiple:!1,"http-request":t},{default:E(()=>[k(h,{type:"primary"},{default:E(()=>[ie("选择")]),_:1})]),_:1})])])}}},vt=be(mt,[["__scopeId","data-v-367a1150"]]),gt={__name:"UpdateAvatar",emits:[],setup(n,{expose:e,emit:s}){const{proxy:t}=_e(),o={updateUserAvatar:"/updateUserAvatar"},a=R({}),i=R(),h={title:[{require:!0,message:"请输入内容"}]},u=rt({show:!1,title:"修改头像",buttons:[{type:"danger",text:"确定",click:c=>{l()}}]}),d=s;e({show:c=>{a.value=Object.assign({},c),a.value.avatar={userId:c.id},u.show=!0}});const l=async()=>{if(!(a.value.avatar instanceof File)){u.show=!1;return}await t.Request({url:o.updateUserAvatar,params:{avatar:a.value.avatar}})&&(u.show=!1,d("updateAvatar"))};return(c,f)=>{const m=T("el-form-item"),g=T("el-form"),y=T("Dialog");return C(),Q(y,{show:u.show,title:u.title,buttons:u.buttons,width:"400px",showCancel:!1,onClose:f[2]||(f[2]=b=>u.show=!1)},{default:E(()=>[k(g,{model:a.value,rules:h,ref:i.value,"label-width":"80px",onSubmit:f[1]||(f[1]=()=>{})},{default:E(()=>[k(m,{label:"昵称"},{default:E(()=>[ie(V(a.value.nickName),1)]),_:1}),k(m,{label:"头像上传",prop:""},{default:E(()=>[k(vt,{modelValue:a.value.avatar,"onUpdate:modelValue":f[0]||(f[0]=b=>a.value.avatar=b)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])}}},_t=_("span",{class:"iconfont icon-password"},null,-1),It=_("span",{class:"iconfont icon-password"},null,-1),yt={__name:"UpdatePassword",setup(n,{expose:e}){const{proxy:s}=_e(),t=(l,c,f)=>{c!==i.value.password?f(new Error(l.message)):f()},o={updatePassword:"/updatePassword"},a=R(),i=R({}),h=R({show:!1,title:"修改密码",buttons:[{type:"primary",text:"确定",click:()=>{p()}}]}),u={password:[{required:!0,message:"请输入密码"},{validator:s.Verify.password,message:"请输入数字,字母,-,_,且长度在8-32之间的密码"}],rePassword:[{required:!0,message:"请再次输入密码"},{validator:t,message:"两次密码不一致"}]};e({show:()=>{h.value.show=!0,De(()=>{a.value.resetFields(),i.value={}})}});const p=()=>{a.value.validate(async l=>{if(!l||!await s.Request({url:o.updatePassword,params:{password:Ee(i.value.password)}}))return;h.value.show=!1;let f=s.LocalStorage.get("loginInfo");f.password=Ee(i.value.password),s.LocalStorage.update("loginInfo",f),s.Message.success("密码修改成功")})};return(l,c)=>{const f=T("el-input"),m=T("el-form-item"),g=T("el-form"),y=T("Dialog");return C(),Q(y,{show:h.value.show,title:h.value.title,buttons:h.value.buttons,width:"400px",showCancel:!1,onClose:c[3]||(c[3]=b=>h.value.show=!1)},{default:E(()=>[k(g,{model:i.value,rules:u,ref_key:"formDataRef",ref:a,"label-width":"80px",onSubmit:c[2]||(c[2]=lt(()=>{},["prevent"]))},{default:E(()=>[k(m,{label:"新密码",prop:"password"},{default:E(()=>[k(f,{clearable:"",placeholder:"请输入密码",modelValue:i.value.password,"onUpdate:modelValue":c[0]||(c[0]=b=>i.value.password=b),modelModifiers:{trim:!0},size:"large","show-password":""},{prefix:E(()=>[_t]),_:1},8,["modelValue"])]),_:1}),k(m,{label:"确认密码",prop:"rePassword"},{default:E(()=>[k(f,{clearable:"",placeholder:"请再次输入密码",modelValue:i.value.rePassword,"onUpdate:modelValue":c[1]||(c[1]=b=>i.value.rePassword=b),modelModifiers:{trim:!0},size:"large","show-password":""},{prefix:E(()=>[It]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])}}},Xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qe="ARRAYBUFFER not supported by this environment",je="UINT8ARRAY not supported by this environment";function Fe(n,e,s,t){let o,a,i;const h=e||[0],u=(s=s||0)>>>3,d=t===-1?3:0;for(o=0;o<n.length;o+=1)i=o+u,a=i>>>2,h.length<=a&&h.push(0),h[a]|=n[o]<<8*(d+t*(i%4));return{value:h,binLen:8*n.length+s}}function re(n,e,s){switch(e){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(n){case"HEX":return function(t,o,a){return function(i,h,u,d){let p,l,c,f;if(i.length%2!=0)throw new Error("String of HEX type must be in byte increments");const m=h||[0],g=(u=u||0)>>>3,y=d===-1?3:0;for(p=0;p<i.length;p+=2){if(l=parseInt(i.substr(p,2),16),isNaN(l))throw new Error("String of HEX type contains invalid characters");for(f=(p>>>1)+g,c=f>>>2;m.length<=c;)m.push(0);m[c]|=l<<8*(y+d*(f%4))}return{value:m,binLen:4*i.length+u}}(t,o,a,s)};case"TEXT":return function(t,o,a){return function(i,h,u,d,p){let l,c,f,m,g,y,b,F,P=0;const v=u||[0],S=(d=d||0)>>>3;if(h==="UTF8")for(b=p===-1?3:0,f=0;f<i.length;f+=1)for(l=i.charCodeAt(f),c=[],128>l?c.push(l):2048>l?(c.push(192|l>>>6),c.push(128|63&l)):55296>l||57344<=l?c.push(224|l>>>12,128|l>>>6&63,128|63&l):(f+=1,l=65536+((1023&l)<<10|1023&i.charCodeAt(f)),c.push(240|l>>>18,128|l>>>12&63,128|l>>>6&63,128|63&l)),m=0;m<c.length;m+=1){for(y=P+S,g=y>>>2;v.length<=g;)v.push(0);v[g]|=c[m]<<8*(b+p*(y%4)),P+=1}else for(b=p===-1?2:0,F=h==="UTF16LE"&&p!==1||h!=="UTF16LE"&&p===1,f=0;f<i.length;f+=1){for(l=i.charCodeAt(f),F===!0&&(m=255&l,l=m<<8|l>>>8),y=P+S,g=y>>>2;v.length<=g;)v.push(0);v[g]|=l<<8*(b+p*(y%4)),P+=2}return{value:v,binLen:8*P+d}}(t,e,o,a,s)};case"B64":return function(t,o,a){return function(i,h,u,d){let p,l,c,f,m,g,y,b=0;const F=h||[0],P=(u=u||0)>>>3,v=d===-1?3:0,S=i.indexOf("=");if(i.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(i=i.replace(/=/g,""),S!==-1&&S<i.length)throw new Error("Invalid '=' found in base-64 string");for(l=0;l<i.length;l+=4){for(m=i.substr(l,4),f=0,c=0;c<m.length;c+=1)p=Xe.indexOf(m.charAt(c)),f|=p<<18-6*c;for(c=0;c<m.length-1;c+=1){for(y=b+P,g=y>>>2;F.length<=g;)F.push(0);F[g]|=(f>>>16-8*c&255)<<8*(v+d*(y%4)),b+=1}}return{value:F,binLen:8*b+u}}(t,o,a,s)};case"BYTES":return function(t,o,a){return function(i,h,u,d){let p,l,c,f;const m=h||[0],g=(u=u||0)>>>3,y=d===-1?3:0;for(l=0;l<i.length;l+=1)p=i.charCodeAt(l),f=l+g,c=f>>>2,m.length<=c&&m.push(0),m[c]|=p<<8*(y+d*(f%4));return{value:m,binLen:8*i.length+u}}(t,o,a,s)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(qe)}return function(t,o,a){return function(i,h,u,d){return Fe(new Uint8Array(i),h,u,d)}(t,o,a,s)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(je)}return function(t,o,a){return Fe(t,o,a,s)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function He(n,e,s,t){switch(n){case"HEX":return function(o){return function(a,i,h,u){const d="0123456789abcdef";let p,l,c="";const f=i/8,m=h===-1?3:0;for(p=0;p<f;p+=1)l=a[p>>>2]>>>8*(m+h*(p%4)),c+=d.charAt(l>>>4&15)+d.charAt(15&l);return u.outputUpper?c.toUpperCase():c}(o,e,s,t)};case"B64":return function(o){return function(a,i,h,u){let d,p,l,c,f,m="";const g=i/8,y=h===-1?3:0;for(d=0;d<g;d+=3)for(c=d+1<g?a[d+1>>>2]:0,f=d+2<g?a[d+2>>>2]:0,l=(a[d>>>2]>>>8*(y+h*(d%4))&255)<<16|(c>>>8*(y+h*((d+1)%4))&255)<<8|f>>>8*(y+h*((d+2)%4))&255,p=0;p<4;p+=1)m+=8*d+6*p<=i?Xe.charAt(l>>>6*(3-p)&63):u.b64Pad;return m}(o,e,s,t)};case"BYTES":return function(o){return function(a,i,h){let u,d,p="";const l=i/8,c=h===-1?3:0;for(u=0;u<l;u+=1)d=a[u>>>2]>>>8*(c+h*(u%4))&255,p+=String.fromCharCode(d);return p}(o,e,s)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(qe)}return function(o){return function(a,i,h){let u;const d=i/8,p=new ArrayBuffer(d),l=new Uint8Array(p),c=h===-1?3:0;for(u=0;u<d;u+=1)l[u]=a[u>>>2]>>>8*(c+h*(u%4))&255;return p}(o,e,s)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(je)}return function(o){return function(a,i,h){let u;const d=i/8,p=h===-1?3:0,l=new Uint8Array(d);for(u=0;u<d;u+=1)l[u]=a[u>>>2]>>>8*(p+h*(u%4))&255;return l}(o,e,s)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const he=4294967296,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],W=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],Z=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],de="Chosen SHA variant is not supported",Ge="Cannot set numRounds with MAC";function ge(n,e){let s,t;const o=n.binLen>>>3,a=e.binLen>>>3,i=o<<3,h=4-o<<3;if(o%4!=0){for(s=0;s<a;s+=4)t=o+s>>>2,n.value[t]|=e.value[s>>>2]<<i,n.value.push(0),n.value[t+1]|=e.value[s>>>2]>>>h;return(n.value.length<<2)-4>=a+o&&n.value.pop(),{value:n.value,binLen:n.binLen+e.binLen}}return{value:n.value.concat(e.value),binLen:n.binLen+e.binLen}}function Le(n){const e={outputUpper:!1,b64Pad:"=",outputLen:-1},s=n||{},t="Output length must be a multiple of 8";if(e.outputUpper=s.outputUpper||!1,s.b64Pad&&(e.b64Pad=s.b64Pad),s.outputLen){if(s.outputLen%8!=0)throw new Error(t);e.outputLen=s.outputLen}else if(s.shakeLen){if(s.shakeLen%8!=0)throw new Error(t);e.outputLen=s.shakeLen}if(typeof e.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof e.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return e}function se(n,e,s,t){const o=n+" must include a value and format";if(!e){if(!t)throw new Error(o);return t}if(e.value===void 0||!e.format)throw new Error(o);return re(e.format,e.encoding||"UTF8",s)(e.value)}class Ie{constructor(e,s,t){const o=t||{};if(this.t=s,this.i=o.encoding||"UTF8",this.numRounds=o.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=e,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(e){let s,t=0;const o=this.m>>>5,a=this.C(e,this.h,this.u),i=a.binLen,h=a.value,u=i>>>5;for(s=0;s<u;s+=o)t+this.m<=i&&(this.U=this.v(h.slice(s,s+o),this.U),t+=this.m);return this.A+=t,this.h=h.slice(t>>>5),this.u=i%this.m,this.l=!0,this}getHash(e,s){let t,o,a=this.R;const i=Le(s);if(this.K){if(i.outputLen===-1)throw new Error("Output length must be specified in options");a=i.outputLen}const h=He(e,a,this.T,i);if(this.H&&this.g)return h(this.g(i));for(o=this.F(this.h.slice(),this.u,this.A,this.L(this.U),a),t=1;t<this.numRounds;t+=1)this.K&&a%32!=0&&(o[o.length-1]&=16777215>>>24-a%32),o=this.F(o,a,0,this.B(this.o),a);return h(o)}setHMACKey(e,s,t){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const o=re(s,(t||{}).encoding||"UTF8",this.T);this.k(o(e))}k(e){const s=this.m>>>3,t=s/4-1;let o;if(this.numRounds!==1)throw new Error(Ge);if(this.H)throw new Error("MAC key already set");for(s<e.binLen/8&&(e.value=this.F(e.value,e.binLen,0,this.B(this.o),this.R));e.value.length<=t;)e.value.push(0);for(o=0;o<=t;o+=1)this.S[o]=909522486^e.value[o],this.p[o]=1549556828^e.value[o];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(e,s){const t=Le(s);return He(e,this.R,this.T,t)(this.Y())}Y(){let e;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");const s=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return e=this.v(this.p,this.B(this.o)),e=this.F(s,this.R,this.m,e,this.R),e}}function ae(n,e){return n<<e|n>>>32-e}function X(n,e){return n>>>e|n<<32-e}function We(n,e){return n>>>e}function Te(n,e,s){return n^e^s}function Ze(n,e,s){return n&e^~n&s}function Qe(n,e,s){return n&e^n&s^e&s}function At(n){return X(n,2)^X(n,13)^X(n,22)}function K(n,e){const s=(65535&n)+(65535&e);return(65535&(n>>>16)+(e>>>16)+(s>>>16))<<16|65535&s}function Nt(n,e,s,t){const o=(65535&n)+(65535&e)+(65535&s)+(65535&t);return(65535&(n>>>16)+(e>>>16)+(s>>>16)+(t>>>16)+(o>>>16))<<16|65535&o}function ce(n,e,s,t,o){const a=(65535&n)+(65535&e)+(65535&s)+(65535&t)+(65535&o);return(65535&(n>>>16)+(e>>>16)+(s>>>16)+(t>>>16)+(o>>>16)+(a>>>16))<<16|65535&a}function St(n){return X(n,7)^X(n,18)^We(n,3)}function bt(n){return X(n,6)^X(n,11)^X(n,25)}function kt(n){return[1732584193,4023233417,2562383102,271733878,3285377520]}function et(n,e){let s,t,o,a,i,h,u;const d=[];for(s=e[0],t=e[1],o=e[2],a=e[3],i=e[4],u=0;u<80;u+=1)d[u]=u<16?n[u]:ae(d[u-3]^d[u-8]^d[u-14]^d[u-16],1),h=u<20?ce(ae(s,5),Ze(t,o,a),i,1518500249,d[u]):u<40?ce(ae(s,5),Te(t,o,a),i,1859775393,d[u]):u<60?ce(ae(s,5),Qe(t,o,a),i,2400959708,d[u]):ce(ae(s,5),Te(t,o,a),i,3395469782,d[u]),i=a,a=o,o=ae(t,30),t=s,s=h;return e[0]=K(s,e[0]),e[1]=K(t,e[1]),e[2]=K(o,e[2]),e[3]=K(a,e[3]),e[4]=K(i,e[4]),e}function Ct(n,e,s,t){let o;const a=15+(e+65>>>9<<4),i=e+s;for(;n.length<=a;)n.push(0);for(n[e>>>5]|=128<<24-e%32,n[a]=4294967295&i,n[a-1]=i/he|0,o=0;o<n.length;o+=16)t=et(n.slice(o,o+16),t);return t}let Ut=class extends Ie{constructor(n,e,s){if(n!=="SHA-1")throw new Error(de);super(n,e,s);const t=s||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=re(this.t,this.i,this.T),this.v=et,this.L=function(o){return o.slice()},this.B=kt,this.F=Ct,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,t.hmacKey&&this.k(se("hmacKey",t.hmacKey,this.T))}};function Me(n){let e;return e=n=="SHA-224"?W.slice():Z.slice(),e}function Pe(n,e){let s,t,o,a,i,h,u,d,p,l,c;const f=[];for(s=e[0],t=e[1],o=e[2],a=e[3],i=e[4],h=e[5],u=e[6],d=e[7],c=0;c<64;c+=1)f[c]=c<16?n[c]:Nt(X(m=f[c-2],17)^X(m,19)^We(m,10),f[c-7],St(f[c-15]),f[c-16]),p=ce(d,bt(i),Ze(i,h,u),w[c],f[c]),l=K(At(s),Qe(s,t,o)),d=u,u=h,h=i,i=K(a,p),a=o,o=t,t=s,s=K(p,l);var m;return e[0]=K(s,e[0]),e[1]=K(t,e[1]),e[2]=K(o,e[2]),e[3]=K(a,e[3]),e[4]=K(i,e[4]),e[5]=K(h,e[5]),e[6]=K(u,e[6]),e[7]=K(d,e[7]),e}let Rt=class extends Ie{constructor(n,e,s){if(n!=="SHA-224"&&n!=="SHA-256")throw new Error(de);super(n,e,s);const t=s||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=re(this.t,this.i,this.T),this.v=Pe,this.L=function(o){return o.slice()},this.B=Me,this.F=function(o,a,i,h){return function(u,d,p,l,c){let f,m;const g=15+(d+65>>>9<<4),y=d+p;for(;u.length<=g;)u.push(0);for(u[d>>>5]|=128<<24-d%32,u[g]=4294967295&y,u[g-1]=y/he|0,f=0;f<u.length;f+=16)l=Pe(u.slice(f,f+16),l);return m=c==="SHA-224"?[l[0],l[1],l[2],l[3],l[4],l[5],l[6]]:l,m}(o,a,i,h,n)},this.U=Me(n),this.m=512,this.R=n==="SHA-224"?224:256,this.K=!1,t.hmacKey&&this.k(se("hmacKey",t.hmacKey,this.T))}};class r{constructor(e,s){this.N=e,this.I=s}}function Ke(n,e){let s;return e>32?(s=64-e,new r(n.I<<e|n.N>>>s,n.N<<e|n.I>>>s)):e!==0?(s=32-e,new r(n.N<<e|n.I>>>s,n.I<<e|n.N>>>s)):n}function q(n,e){let s;return e<32?(s=32-e,new r(n.N>>>e|n.I<<s,n.I>>>e|n.N<<s)):(s=64-e,new r(n.I>>>e|n.N<<s,n.N>>>e|n.I<<s))}function tt(n,e){return new r(n.N>>>e,n.I>>>e|n.N<<32-e)}function Et(n,e,s){return new r(n.N&e.N^n.N&s.N^e.N&s.N,n.I&e.I^n.I&s.I^e.I&s.I)}function Ft(n){const e=q(n,28),s=q(n,34),t=q(n,39);return new r(e.N^s.N^t.N,e.I^s.I^t.I)}function Y(n,e){let s,t;s=(65535&n.I)+(65535&e.I),t=(n.I>>>16)+(e.I>>>16)+(s>>>16);const o=(65535&t)<<16|65535&s;return s=(65535&n.N)+(65535&e.N)+(t>>>16),t=(n.N>>>16)+(e.N>>>16)+(s>>>16),new r((65535&t)<<16|65535&s,o)}function Ht(n,e,s,t){let o,a;o=(65535&n.I)+(65535&e.I)+(65535&s.I)+(65535&t.I),a=(n.I>>>16)+(e.I>>>16)+(s.I>>>16)+(t.I>>>16)+(o>>>16);const i=(65535&a)<<16|65535&o;return o=(65535&n.N)+(65535&e.N)+(65535&s.N)+(65535&t.N)+(a>>>16),a=(n.N>>>16)+(e.N>>>16)+(s.N>>>16)+(t.N>>>16)+(o>>>16),new r((65535&a)<<16|65535&o,i)}function Lt(n,e,s,t,o){let a,i;a=(65535&n.I)+(65535&e.I)+(65535&s.I)+(65535&t.I)+(65535&o.I),i=(n.I>>>16)+(e.I>>>16)+(s.I>>>16)+(t.I>>>16)+(o.I>>>16)+(a>>>16);const h=(65535&i)<<16|65535&a;return a=(65535&n.N)+(65535&e.N)+(65535&s.N)+(65535&t.N)+(65535&o.N)+(i>>>16),i=(n.N>>>16)+(e.N>>>16)+(s.N>>>16)+(t.N>>>16)+(o.N>>>16)+(a>>>16),new r((65535&i)<<16|65535&a,h)}function ue(n,e){return new r(n.N^e.N,n.I^e.I)}function Tt(n){const e=q(n,19),s=q(n,61),t=tt(n,6);return new r(e.N^s.N^t.N,e.I^s.I^t.I)}function Mt(n){const e=q(n,1),s=q(n,8),t=tt(n,7);return new r(e.N^s.N^t.N,e.I^s.I^t.I)}function Pt(n){const e=q(n,14),s=q(n,18),t=q(n,41);return new r(e.N^s.N^t.N,e.I^s.I^t.I)}const Kt=[new r(w[0],3609767458),new r(w[1],602891725),new r(w[2],3964484399),new r(w[3],2173295548),new r(w[4],4081628472),new r(w[5],3053834265),new r(w[6],2937671579),new r(w[7],3664609560),new r(w[8],2734883394),new r(w[9],1164996542),new r(w[10],1323610764),new r(w[11],3590304994),new r(w[12],4068182383),new r(w[13],991336113),new r(w[14],633803317),new r(w[15],3479774868),new r(w[16],2666613458),new r(w[17],944711139),new r(w[18],2341262773),new r(w[19],2007800933),new r(w[20],1495990901),new r(w[21],1856431235),new r(w[22],3175218132),new r(w[23],2198950837),new r(w[24],3999719339),new r(w[25],766784016),new r(w[26],2566594879),new r(w[27],3203337956),new r(w[28],1034457026),new r(w[29],2466948901),new r(w[30],3758326383),new r(w[31],168717936),new r(w[32],1188179964),new r(w[33],1546045734),new r(w[34],1522805485),new r(w[35],2643833823),new r(w[36],2343527390),new r(w[37],1014477480),new r(w[38],1206759142),new r(w[39],344077627),new r(w[40],1290863460),new r(w[41],3158454273),new r(w[42],3505952657),new r(w[43],106217008),new r(w[44],3606008344),new r(w[45],1432725776),new r(w[46],1467031594),new r(w[47],851169720),new r(w[48],3100823752),new r(w[49],1363258195),new r(w[50],3750685593),new r(w[51],3785050280),new r(w[52],3318307427),new r(w[53],3812723403),new r(w[54],2003034995),new r(w[55],3602036899),new r(w[56],1575990012),new r(w[57],1125592928),new r(w[58],2716904306),new r(w[59],442776044),new r(w[60],593698344),new r(w[61],3733110249),new r(w[62],2999351573),new r(w[63],3815920427),new r(3391569614,3928383900),new r(3515267271,566280711),new r(3940187606,3454069534),new r(4118630271,4000239992),new r(116418474,1914138554),new r(174292421,2731055270),new r(289380356,3203993006),new r(460393269,320620315),new r(685471733,587496836),new r(852142971,1086792851),new r(1017036298,365543100),new r(1126000580,2618297676),new r(1288033470,3409855158),new r(1501505948,4234509866),new r(1607167915,987167468),new r(1816402316,1246189591)];function xe(n){return n==="SHA-384"?[new r(3418070365,W[0]),new r(1654270250,W[1]),new r(2438529370,W[2]),new r(355462360,W[3]),new r(1731405415,W[4]),new r(41048885895,W[5]),new r(3675008525,W[6]),new r(1203062813,W[7])]:[new r(Z[0],4089235720),new r(Z[1],2227873595),new r(Z[2],4271175723),new r(Z[3],1595750129),new r(Z[4],2917565137),new r(Z[5],725511199),new r(Z[6],4215389547),new r(Z[7],327033209)]}function $e(n,e){let s,t,o,a,i,h,u,d,p,l,c,f;const m=[];for(s=e[0],t=e[1],o=e[2],a=e[3],i=e[4],h=e[5],u=e[6],d=e[7],c=0;c<80;c+=1)c<16?(f=2*c,m[c]=new r(n[f],n[f+1])):m[c]=Ht(Tt(m[c-2]),m[c-7],Mt(m[c-15]),m[c-16]),p=Lt(d,Pt(i),(y=h,b=u,new r((g=i).N&y.N^~g.N&b.N,g.I&y.I^~g.I&b.I)),Kt[c],m[c]),l=Y(Ft(s),Et(s,t,o)),d=u,u=h,h=i,i=Y(a,p),a=o,o=t,t=s,s=Y(p,l);var g,y,b;return e[0]=Y(s,e[0]),e[1]=Y(t,e[1]),e[2]=Y(o,e[2]),e[3]=Y(a,e[3]),e[4]=Y(i,e[4]),e[5]=Y(h,e[5]),e[6]=Y(u,e[6]),e[7]=Y(d,e[7]),e}let xt=class extends Ie{constructor(n,e,s){if(n!=="SHA-384"&&n!=="SHA-512")throw new Error(de);super(n,e,s);const t=s||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=re(this.t,this.i,this.T),this.v=$e,this.L=function(o){return o.slice()},this.B=xe,this.F=function(o,a,i,h){return function(u,d,p,l,c){let f,m;const g=31+(d+129>>>10<<5),y=d+p;for(;u.length<=g;)u.push(0);for(u[d>>>5]|=128<<24-d%32,u[g]=4294967295&y,u[g-1]=y/he|0,f=0;f<u.length;f+=32)l=$e(u.slice(f,f+32),l);return m=c==="SHA-384"?[l[0].N,l[0].I,l[1].N,l[1].I,l[2].N,l[2].I,l[3].N,l[3].I,l[4].N,l[4].I,l[5].N,l[5].I]:[l[0].N,l[0].I,l[1].N,l[1].I,l[2].N,l[2].I,l[3].N,l[3].I,l[4].N,l[4].I,l[5].N,l[5].I,l[6].N,l[6].I,l[7].N,l[7].I],m}(o,a,i,h,n)},this.U=xe(n),this.m=1024,this.R=n==="SHA-384"?384:512,this.K=!1,t.hmacKey&&this.k(se("hmacKey",t.hmacKey,this.T))}};const $t=[new r(0,1),new r(0,32898),new r(2147483648,32906),new r(2147483648,2147516416),new r(0,32907),new r(0,2147483649),new r(2147483648,2147516545),new r(2147483648,32777),new r(0,138),new r(0,136),new r(0,2147516425),new r(0,2147483658),new r(0,2147516555),new r(2147483648,139),new r(2147483648,32905),new r(2147483648,32771),new r(2147483648,32770),new r(2147483648,128),new r(0,32778),new r(2147483648,2147483658),new r(2147483648,2147516545),new r(2147483648,32896),new r(0,2147483649),new r(2147483648,2147516424)],zt=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function Se(n){let e;const s=[];for(e=0;e<5;e+=1)s[e]=[new r(0,0),new r(0,0),new r(0,0),new r(0,0),new r(0,0)];return s}function Bt(n){let e;const s=[];for(e=0;e<5;e+=1)s[e]=n[e].slice();return s}function we(n,e){let s,t,o,a;const i=[],h=[];if(n!==null)for(t=0;t<n.length;t+=2)e[(t>>>1)%5][(t>>>1)/5|0]=ue(e[(t>>>1)%5][(t>>>1)/5|0],new r(n[t+1],n[t]));for(s=0;s<24;s+=1){for(a=Se(),t=0;t<5;t+=1)i[t]=(u=e[t][0],d=e[t][1],p=e[t][2],l=e[t][3],c=e[t][4],new r(u.N^d.N^p.N^l.N^c.N,u.I^d.I^p.I^l.I^c.I));for(t=0;t<5;t+=1)h[t]=ue(i[(t+4)%5],Ke(i[(t+1)%5],1));for(t=0;t<5;t+=1)for(o=0;o<5;o+=1)e[t][o]=ue(e[t][o],h[t]);for(t=0;t<5;t+=1)for(o=0;o<5;o+=1)a[o][(2*t+3*o)%5]=Ke(e[t][o],zt[t][o]);for(t=0;t<5;t+=1)for(o=0;o<5;o+=1)e[t][o]=ue(a[t][o],new r(~a[(t+1)%5][o].N&a[(t+2)%5][o].N,~a[(t+1)%5][o].I&a[(t+2)%5][o].I));e[0][0]=ue(e[0][0],$t[s])}var u,d,p,l,c;return e}function st(n){let e,s,t=0;const o=[0,0],a=[4294967295&n,n/he&2097151];for(e=6;e>=0;e--)s=a[e>>2]>>>8*e&255,s===0&&t===0||(o[t+1>>2]|=s<<8*(t+1),t+=1);return t=t!==0?t:1,o[0]|=t,{value:t+1>4?o:[o[0]],binLen:8+8*t}}function Ae(n){return ge(st(n.binLen),n)}function ze(n,e){let s,t=st(e);t=ge(t,n);const o=e>>>2,a=(o-t.value.length%o)%o;for(s=0;s<a;s++)t.value.push(0);return t.value}let Ot=class extends Ie{constructor(n,e,s){let t=6,o=0;super(n,e,s);const a=s||{};if(this.numRounds!==1){if(a.kmacKey||a.hmacKey)throw new Error(Ge);if(this.o==="CSHAKE128"||this.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=re(this.t,this.i,this.T),this.v=we,this.L=Bt,this.B=Se,this.U=Se(),this.K=!1,n){case"SHA3-224":this.m=o=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=o=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=o=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=o=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":t=31,this.m=o=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":t=31,this.m=o=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":t=4,this.m=o=1344,this.X(s),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":t=4,this.m=o=1088,this.X(s),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=o=1344,t=this.O(s),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=o=1088,t=this.O(s),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(de)}this.F=function(i,h,u,d,p){return function(l,c,f,m,g,y,b){let F,P,v=0;const S=[],N=g>>>5,U=c>>>5;for(F=0;F<U&&c>=g;F+=N)m=we(l.slice(F,F+N),m),c-=g;for(l=l.slice(F),c%=g;l.length<N;)l.push(0);for(F=c>>>3,l[F>>2]^=y<<F%4*8,l[N-1]^=2147483648,m=we(l,m);32*S.length<b&&(P=m[v%5][v/5|0],S.push(P.I),!(32*S.length>=b));)S.push(P.N),v+=1,64*v%g==0&&(we(null,m),v=0);return S}(i,h,0,d,o,t,p)},a.hmacKey&&this.k(se("hmacKey",a.hmacKey,this.T))}O(n,e){const s=function(o){const a=o||{};return{funcName:se("funcName",a.funcName,1,{value:[],binLen:0}),customization:se("Customization",a.customization,1,{value:[],binLen:0})}}(n||{});e&&(s.funcName=e);const t=ge(Ae(s.funcName),Ae(s.customization));if(s.customization.binLen!==0||s.funcName.binLen!==0){const o=ze(t,this.m>>>3);for(let a=0;a<o.length;a+=this.m>>>5)this.U=this.v(o.slice(a,a+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(n){const e=function(t){const o=t||{};return{kmacKey:se("kmacKey",o.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:se("Customization",o.customization,1,{value:[],binLen:0})}}(n||{});this.O(n,e.funcName);const s=ze(Ae(e.kmacKey),this.m>>>3);for(let t=0;t<s.length;t+=this.m>>>5)this.U=this.v(s.slice(t,t+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(n){const e=ge({value:this.h.slice(),binLen:this.u},function(s){let t,o,a=0;const i=[0,0],h=[4294967295&s,s/he&2097151];for(t=6;t>=0;t--)o=h[t>>2]>>>8*t&255,o===0&&a===0||(i[a>>2]|=o<<8*a,a+=1);return a=a!==0?a:1,i[a>>2]|=a<<8*a,{value:a+1>4?i:[i[0]],binLen:8+8*a}}(n.outputLen));return this.F(e.value,e.binLen,this.A,this.L(this.U),n.outputLen)}};class Dt{constructor(e,s,t){if(e=="SHA-1")this.P=new Ut(e,s,t);else if(e=="SHA-224"||e=="SHA-256")this.P=new Rt(e,s,t);else if(e=="SHA-384"||e=="SHA-512")this.P=new xt(e,s,t);else{if(e!="SHA3-224"&&e!="SHA3-256"&&e!="SHA3-384"&&e!="SHA3-512"&&e!="SHAKE128"&&e!="SHAKE256"&&e!="CSHAKE128"&&e!="CSHAKE256"&&e!="KMAC128"&&e!="KMAC256")throw new Error(de);this.P=new Ot(e,s,t)}}update(e){return this.P.update(e),this}getHash(e,s){return this.P.getHash(e,s)}setHMACKey(e,s,t){this.P.setHMACKey(e,s,t)}getHMAC(e,s){return this.P.getHMAC(e,s)}}const ke=n=>(Ve("data-v-3bcd4666"),n=n(),Je(),n),Yt={class:"uploader-panel"},Vt={class:"uploader-title"},Jt=ke(()=>_("span",null,"上传任务",-1)),Xt=ke(()=>_("span",{class:"tips"},"（仅展示本次上传任务）",-1)),qt=ke(()=>_("span",{class:"iconfont icon-del m-right"},null,-1)),jt={class:"file-list"},Gt={class:"upload-panel"},Wt={class:"file-name"},Zt={class:"progress"},Qt={class:"upload-status"},es={key:0,class:"upload-info"},ts={class:"op"},ss={class:"op-btn"},ns={key:0},os={key:0},G=1024*1024*5,as={__name:"Uploader",emits:["uploadCallback"],setup(n,{expose:e,emit:s}){const{proxy:t}=_e(),o={upload:"/file/uploadFile"},a=R([]),i={emptyfile:{value:"emptyfile",desc:"文件为空",color:"#F75000",icon:"close"},fail:{value:"fail",desc:"上传失败",color:"#F75000",icon:"close"},init:{value:"init",desc:"解析中",color:"#e6a23c",icon:"clock"},uploading:{value:"uploading",desc:"上传中",color:"#409eff",icon:"upload"},upload_finish:{value:"upload_finish",desc:"上传完成",color:"#67c23a",icon:"ok"},upload_seconds:{value:"upload_seconds",desc:"秒传",color:"#67c23a",icon:"ok"}},h=R([]),u=v=>new Promise((S,N)=>{const U=new Worker("/worker.js");U.onmessage=H=>{S(H.data),U.terminate()},U.onerror=N,U.postMessage(v)}),d=async v=>{let S=v.file,N=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,U=Math.ceil(S.size/G),H=0,j=new Dt("SHA3-256","TEXT"),I=new FileReader,B=()=>{let L=H*G,oe=L+G>=S.size?S.size:L+G;I.readAsArrayBuffer(N.call(S,L,oe))};return B(),new Promise((L,oe)=>{let z=p(S.uid);z.md5Progress=0,I.onload=async J=>{let O=await u(J.target.result);if(j.update(O),H++,H<U){let A=Math.floor(H/U*100);z.md5Progress=A,B()}else{let A=j.getHash("HEX");z.md5Progress=100,z.status=i.uploading.value,z.md5=A,L(v.uid)}},I.onerror=J=>{z.md5Progress=-1,z.status=i.fail.value,L(v.uid)}}).catch(L=>(console.error(L),null))},p=v=>a.value.find(N=>N.file.uid===v),l=(v,S)=>{for(let N=0;N<a.value.length;N++)if(a.value[N].file.uid===v){Object.assign(a.value[N],S);break}},c=v=>{l(v,{pause:!1}),P(v,p(v).chunkIndex),localStorage.setItem("filelist",JSON.stringify(a.value))},f=v=>{l(v,{pause:!0}),localStorage.setItem("filelist",JSON.stringify(a.value))},m=()=>{a.value=[],localStorage.setItem("filelist",JSON.stringify(a.value))},g=(v,S)=>{a.value.splice(S,1),localStorage.setItem("filelist",JSON.stringify(a.value))},y=(v,S)=>{a.value.splice(S,1),localStorage.setItem("filelist",JSON.stringify(a.value))};Ye(()=>{let v=localStorage.getItem("filelist");v&&(a.value=JSON.parse(v))});const b=s;e({addFile:async(v,S)=>{const N={file:v,uid:v.uid,md5Progress:0,md5:null,fileName:v.name,status:i.init.value,uploadSize:0,totalSize:v.size,uploadProgress:0,pause:!1,chunkIndex:0,filePid:S,errorMsg:null,type:v.type};if(a.value.unshift(N),N.totalSize==0){N.status=i.emptyfile.value,localStorage.setItem("filelist",JSON.stringify(a.value));return}let U=await d(N);U!=null&&P(U)}});const P=async(v,S)=>{S=S||0;let N=p(v),U=N.file;if(!U.name)try{U=await t.IdbFileTool.getFile(v)}catch(I){t.Message.error(I);return}const H=N.totalSize,j=Math.ceil(H/G);for(let I=S;I<j;I++){let B=h.value.indexOf(v);if(B!=-1){h.value.slice(B,1);break}if(N.pause){l(v,{chunkIndex:I}),t.IdbFileTool.saveFile(U,v),localStorage.setItem("filelist",JSON.stringify(a.value));return}let L=I*G,oe=L+G>=H?H:L+G,z=U.slice(L,oe),J=await t.Request({url:o.upload,showLoading:!1,dataType:"file",params:{file:z,fileName:U.name,fileMd5:N.md5,chunkIndex:I,chunks:j,fileId:N.fileId,filePid:N.filePid},showError:!1,errorCallback:O=>{N.status=i.fail.value,N.errorMsg=O},onUploadProgressCallback:O=>{let A=O.loaded;A>H&&(A=H),N.uploadSize=I*G+A,N.uploadProgress=Math.floor(N.uploadSize/H*100)}});if(J==null)break;if(N.fileId=J.fileId,N.status=i[J.status].value,N.chunkIndex=I,J.status==i.upload_seconds.value||J.status==i.upload_finish.value){t.IdbFileTool.delFile(v),N.uploadProgress=100,b("uploadCallback");break}}localStorage.setItem("filelist",JSON.stringify(a.value))};return(v,S)=>{const N=T("el-button"),U=T("el-progress"),H=T("Icon"),j=T("NoData");return C(),x("div",Yt,[_("div",Vt,[Jt,Xt,k(N,{type:"danger",onClick:m,disabled:a.value.length==0},{default:E(()=>[qt,ie(" 清空 ")]),_:1},8,["disabled"])]),_("div",jt,[(C(!0),x(me,null,Ne(a.value,(I,B)=>(C(),x("div",{key:B,class:"file-item"},[_("div",Gt,[_("div",Wt,V(I.fileName),1),_("div",Zt,[I.status==i.uploading.value||I.status==i.upload_seconds.value||I.status==i.upload_finish.value?(C(),Q(U,{key:0,percentage:I.uploadProgress},null,8,["percentage"])):te("",!0)]),_("div",Qt,[_("span",{class:ne(["iconfont","icon-"+i[I.status].icon]),style:Ce({color:i[I.status].color})},null,6),_("span",{class:"stauts",style:Ce({color:i[I.status].color})},V(I.status=="fail"?I.errorMsg:i[I.status].desc),5),I.status==i.uploading.value?(C(),x("span",es,V(ve(t).Utils.size2Str(I.uploadSize))+" / "+V(ve(t).Utils.size2Str(I.totalSize)),1)):te("",!0)])]),_("div",ts,[I.status==i.init.value?(C(),Q(U,{key:0,type:"circle",width:50,percentage:I.md5Progress},null,8,["percentage"])):te("",!0),_("div",ss,[I.status==i.uploading.value?(C(),x("span",ns,[I.pause?(C(),Q(H,{key:0,width:28,class:"btn-item",iconName:"upload",title:"上传",onClick:L=>c(I.uid)},null,8,["onClick"])):(C(),Q(H,{key:1,width:28,class:"btn-item",iconName:"pause",title:"暂停",onClick:L=>f(I.uid)},null,8,["onClick"]))])):te("",!0),I.status!=i.init.value&&I.status!=i.upload_finish.value&&I.status!=i.upload_seconds.value?(C(),Q(H,{key:1,width:28,class:"btn-item",iconName:"del",title:"删除",onClick:L=>g(I.uid,B)},null,8,["onClick"])):te("",!0),I.status==i.upload_finish.value||I.status==i.upload_seconds.value?(C(),Q(H,{key:2,width:28,class:"btn-item",iconName:"clean",title:"清除",onClick:L=>y(I.uid,B)},null,8,["onClick"])):te("",!0)])])]))),128)),a.value.length==0?(C(),x("div",os,[k(j,{msg:"暂无上传任务"})])):te("",!0)])])}}},is=be(as,[["__scopeId","data-v-3bcd4666"]]),fe=n=>(Ve("data-v-84cbf204"),n=n(),Je(),n),rs=fe(()=>_("h2",null,"放入当前文件夹",-1)),ls=[rs],us={class:"header"},cs=fe(()=>_("span",{class:"iconfont icon-pan"},null,-1)),hs=fe(()=>_("div",{class:"name"},"My Pan",-1)),ds=[cs,hs],fs={class:"right-panel"},ps=fe(()=>_("span",{class:"iconfont icon-transfer"},null,-1)),ws={class:"user-info"},ms={class:"avatar"},vs={class:"nickname"},gs={class:"body"},_s={class:"left-sider"},Is={class:"menu-list"},ys=["onClick"],As={class:"text"},Ns={class:"menu-sub-list"},Ss=["onClick"],bs={class:"text"},ks={class:"space-info"},Cs=fe(()=>_("div",null,"空间使用",-1)),Us={class:"percent"},Rs={class:"space-use"},Es={class:"use"},Fs={class:"body-content"},Hs={__name:"Layout",setup(n){const e=Be(),s=Oe(),{proxy:t}=_e(),o={getUserInfo:"/getUserInfo",logout:"/logout",getUseSpace:"/getUseSpace"},a=R(0),i=R({}),h=R(!1),u=R([{icon:"cloude",name:"首页",menuCode:"main",path:"/main/all",allShow:!0,children:[{icon:"all",name:"全部",category:"all",path:"/main/all"},{icon:"video",name:"视频",category:"video",path:"/main/video"},{icon:"music",name:"音频",category:"music",path:"/main/music"},{icon:"image",name:"图片",category:"image",path:"/main/image"},{icon:"doc",name:"文档",category:"doc",path:"/main/doc"},{icon:"more",name:"其他",category:"other",path:"/main/others"}]},{path:"/myshare",icon:"share",name:"分享",menuCode:"share",allShow:!0,children:[{name:"分享记录",path:"/myshare"}]},{path:"/recycle",icon:"del",name:"回收站",menuCode:"recycle",tips:"回收站为您保存10天内删除的文件",allShow:!0,children:[{name:"回收站",path:"/recycle"}]}]),d=R({}),p=R(),l=R(!1),c=R(),f=R(),m=R(),g=R(null),y=R(),b=R({useSpace:0,totalSpace:1}),F=A=>{!A.path||A.menuCode==d.value.menuCode||e.push(A.path)},P=()=>{console.log("goHome"),e.push("/")},v=(A,$)=>{const D=u.value.find(ee=>ee.menuCode==A);d.value=D,p.value=$},S=()=>{let A=JSON.parse(sessionStorage.getItem("user"));A.avatar=null,i.value=A,a.value=new Date().getTime()},N=()=>{f.value.show(i.value)},U=()=>{m.value.show()},H=A=>{const{file:$,filePid:D,addFileCallback:ee}=A;l.value=!0,c.value.addFile($,D),g.value=ee},j=()=>{De(()=>{y.value.reload(),O()})},I=()=>{let A=JSON.parse(sessionStorage.getItem("user"));A&&A.isAdmin&&u.value.length==3&&u.value.push({path:"/settings/fileList",icon:"settings",name:"设置",menuCode:"settings",allShow:!0,children:[{name:"用户文件",path:"/settings/fileList"},{name:"用户管理",path:"/settings/userList"},{name:"系统管理",path:"/settings/sysSetting"}]})},B=A=>{A.preventDefault();const $=A.dataTransfer.items;for(const D of $){const ee=D.getAsFile(),le=t.Utils.fileUid();ee.uid=le;let pe=D.webkitGetAsEntry();y.value.dropFile&&(pe.isFile?y.value.dropFile(ee):t.Confirm("你确定要上传文件夹以及其中所有的文件到当前目录吗？",()=>{y.value.dropFolder(pe)}))}h.value=!1};let L=null;const oe=A=>{y.value.dropFile&&(A.preventDefault(),L&&clearTimeout(L),L=setTimeout(()=>{h.value=!1},1e3),h.value=!0)};Ye(async()=>{await z();let A=JSON.parse(sessionStorage.getItem("user"));A.avatar=null,i.value=A,I(),O()});const z=async()=>{sessionStorage.getItem("user");const A=await t.Request({url:o.getUserInfo,params:{}});A&&sessionStorage.setItem("user",JSON.stringify(A))},J=()=>{t.Confirm("您确定要退出吗？",async()=>{await t.Request({url:o.logout})&&(sessionStorage.clear(),t.LocalStorage.remove("loginInfo"),e.push("/login"))})},O=async()=>{let A=await t.Request({url:o.getUseSpace,showLoading:!1});A&&(b.value=A)};return ut(()=>s,async(A,$)=>{await O(),await z();let D=sessionStorage.getItem("user");D!=null&&D&&I(),A.meta.menuCode&&v(A.meta.menuCode,A.path)},{immediate:!0,deep:!0}),(A,$)=>{const D=T("el-popover"),ee=T("Avatar"),le=T("el-dropdown-item"),pe=T("el-dropdown-menu"),nt=T("el-dropdown"),ot=T("el-progress"),at=T("router-view");return C(),x("div",{class:"framework",onDrop:$[1]||($[1]=M=>B(M)),onDragover:$[2]||($[2]=M=>oe(M))},[_("div",{id:"mask",class:ne(["mask",h.value?"show":""])},null,2),_("div",{id:"modal",class:ne(["modal",h.value?"show":""])},ls,2),_("div",us,[_("div",{class:"logo",onClick:P},ds),_("div",fs,[k(D,{width:800,trigger:"click",visible:l.value,"onUpdate:visible":$[0]||($[0]=M=>l.value=M),offset:20,transition:"none","hide-after":0,"popper-style":{padding:"0px"}},{reference:E(()=>[ps]),default:E(()=>[k(is,{ref_key:"uploaderRef",ref:c,onUploadCallback:j},null,512)]),_:1},8,["visible"]),k(nt,null,{dropdown:E(()=>[k(pe,null,{default:E(()=>[k(le,{onClick:N},{default:E(()=>[ie("修改头像")]),_:1}),k(le,{onClick:U},{default:E(()=>[ie("修改密码")]),_:1}),k(le,{onClick:J},{default:E(()=>[ie("退出登录")]),_:1})]),_:1})]),default:E(()=>[_("div",ws,[_("div",ms,[k(ee,{userId:i.value.id,avatar:i.value.avatar,timestamp:a.value,width:46},null,8,["userId","avatar","timestamp"])]),_("span",vs,V(i.value.nickName),1)])]),_:1})])]),_("div",gs,[_("div",_s,[_("div",Is,[(C(!0),x(me,null,Ne(u.value,(M,ye)=>(C(),x("div",{onClick:it=>F(M),class:ne(["menu-item",M.menuCode==d.value.menuCode?"active":""]),key:ye},[_("div",{class:ne(["iconfont","icon-"+M.icon])},null,2),_("div",As,V(M.name),1)],10,ys))),128))]),_("div",Ns,[(C(!0),x(me,null,Ne(d.value.children,(M,ye)=>(C(),x("div",{onClick:it=>F(M),class:ne(["menu-item-sub",p.value==M.path?"active":""]),key:ye},[Ue(_("span",{class:ne(["iconfont","icon-"+M.icon])},null,2),[[Re,M.icon]]),_("span",bs,V(M.name),1)],10,Ss))),128)),Ue(_("div",{class:"tips"},V(d.value.tips),513),[[Re,d.value&&d.value.tips]]),_("div",ks,[Cs,_("div",Us,[k(ot,{percentage:Math.floor(b.value.useSpace/b.value.totalSpace*1e4)/100,color:"#409eff"},null,8,["percentage"]),_("div",Rs,[_("div",Es,V(ve(t).Utils.size2Str(b.value.useSpace))+" / "+V(ve(t).Utils.size2Str(b.value.totalSpace)),1),_("div",{class:"iconfont icon-refresh",onClick:O})])])])])]),_("div",Fs,[k(at,null,{default:E(({Component:M})=>[(C(),Q(ct(M),{ref_key:"routerViewRef",ref:y,onAddFile:H,onReload:O},null,544))]),_:1})])]),k(gt,{ref_key:"updateAvatarRef",ref:f,onUpdateAvatar:S},null,512),k(yt,{ref_key:"updatePasswordRef",ref:m},null,512)],32)}}},Ms=be(Hs,[["__scopeId","data-v-84cbf204"]]);export{Ms as default};
